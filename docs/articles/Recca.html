<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recca • Recca</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Recca">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Recca</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.18</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Recca.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/new-function-interaction.html">new_* function interactions</a>
    </li>
    <li>
      <a href="../articles/new-functions.html">new_* functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MatthewHeun/Recca">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Recca</h1>
                        <h4 class="author">Matthew Kuperus Heun</h4>
            
            <h4 class="date">2020-03-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MatthewHeun/Recca/blob/master/vignettes/Recca.Rmd"><code>vignettes/Recca.Rmd</code></a></small>
      <div class="hidden name"><code>Recca.Rmd</code></div>

    </div>

    
    
<!-- Establish some helpful LaTeX shortcuts for equations -->



<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p><code>Recca</code> (<code>R</code> Energy Conversion Chain Analysis) is an <code>R</code> package that enables energy and exergy analysis of energy conversion chains. <code>Recca</code> makes extensive use of a matrix-based Physical Supply Use Table (PSUT) analysis technique that first appeared in <a href="https://doi.org/10.1016/j.apenergy.2018.05.109">Heun et al. <span class="citation">(2018)</span></a>. This vignette walks through many of the calculations from <a href="https://doi.org/10.1016/j.apenergy.2018.05.109">Heun et al. <span class="citation">(2018)</span></a>, guided by section numbers from the paper. We begin by discussing the design philosophy of the <code>Recca</code> package, followed by a discussion of the PSUT matrices that comprise an energy conversion chain (ECC). Thereafter, calculation of the input-output structure of an ECC is demonstrated. Finally, advanced calculations are shown, including changes in final demand, net energy analysis, industry efficiencies, and energy footprints.</p>
</div>
<div id="design-philosophy" class="section level2">
<h2 class="hasAnchor">
<a href="#design-philosophy" class="anchor"></a>Design philosophy</h2>
<p>The functions in <code>Recca</code> are flexibly designed and useful in many situations. <code>Recca</code>’s flexibility stems from its extensive use of the <code>matsbyname</code> and <code>matsindf</code> packages under the hood. Inputs to most <code>Recca</code> functions can be any one of:</p>
<ol style="list-style-type: decimal">
<li>matrices (with individual matrices as arguments to <code>Recca</code> functions),</li>
<li>a list as the first argument (with names in the list indicating argument names), or</li>
<li>a data frame (with names of data frame columns, as strings, as arguments to <code>Recca</code> functions).</li>
</ol>
<p>Outputs are either named matrices in a list (for 1 and 2 above) or named columns appended to the input data frame (for 3 above).</p>
<p>Argument names for matrices follow a standard nomenclature. It is recommended that the default matrix names be used whenever possible, thereby allowing cleaner code.</p>
</div>
<div id="psut-matrices" class="section level2">
<h2 class="hasAnchor">
<a href="#psut-matrices" class="anchor"></a>PSUT matrices</h2>
<p>(Reference <a href="https://doi.org/10.1016/j.apenergy.2018.05.109">Heun et al. <span class="citation">(2018)</span></a>, Section 2.2.2.)</p>
<p>For the examples that follow, we’ll use the <code>UKEnergy2000tidy</code> data frame. Each row of <code>UKEnergy2000tidy</code> data frame represents another datum for a portion of the ECC for the UK in 2000. <code>UKEnergy2000tidy</code> is in a format similar to data from the IEA or other organizations.</p>
<p>For data in the format of <code>UKEnergy2000tidy</code>, we can create <code>S_units</code> matrices for each grouping using the <code><a href="../reference/S_units_from_tidy.html">S_units_from_tidy()</a></code> function.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tibble)</span>
<span id="cb1-2"><a href="#cb1-2"></a>S_units &lt;-<span class="st"> </span>UKEnergy2000tidy <span class="op">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="st">  </span><span class="kw">group_by</span>(Country, Year, Energy.type, Last.stage) <span class="op">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="st">  </span><span class="kw"><a href="../reference/S_units_from_tidy.html">S_units_from_tidy</a></span>()</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw"><a href="https://tibble.tidyverse.org/reference/glimpse.html">glimpse</a></span>(S_units)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt; Observations: 4</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt; Variables: 5</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#&gt; $ Country     &lt;chr&gt; "GB", "GB", "GB", "GB"</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#&gt; $ Year        &lt;int&gt; 2000, 2000, 2000, 2000</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">#&gt; $ Energy.type &lt;chr&gt; "E.ktoe", "E.ktoe", "E.ktoe", "X.ktoe"</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt; $ Last.stage  &lt;chr&gt; "final", "services", "useful", "services"</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">#&gt; $ S_units     &lt;list&gt; [&lt;matrix[12 x 1]&gt;, &lt;matrix[20 x 5]&gt;, &lt;matrix[16 x 1]&gt;, &lt;…</span></span></code></pre></div>
<p>And we can identify which entries belong in the resource (<span class="math inline">\(\mathbf{R}\)</span>), make (<span class="math inline">\(\mathbf{V}\)</span>), use (<span class="math inline">\(\mathbf{U}\)</span>), and final demand (<span class="math inline">\(\mathbf{Y}\)</span>) matrices with the <code><a href="../reference/add_matnames_iea.html">add_matnames_iea()</a></code> and <code><a href="../reference/add_row_col_meta.html">add_row_col_meta()</a></code> functions.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>WithNames &lt;-<span class="st"> </span>UKEnergy2000tidy <span class="op">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="st">  </span><span class="co"># Add a column indicating the matrix in which this entry belongs (U, V, or Y).</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="st">  </span><span class="kw"><a href="../reference/add_matnames_iea.html">add_matnames_iea</a></span>(<span class="dt">use_R =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="st">  </span><span class="co"># Add metadata columns for row names, column names, row types, and column types.</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="st">  </span><span class="kw"><a href="../reference/add_row_col_meta.html">add_row_col_meta</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="st">  </span><span class="co"># Eliminate columns we no longer need</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Ledger.side, <span class="op">-</span>Flow.aggregation.point, <span class="op">-</span>Flow, <span class="op">-</span>Product) <span class="op">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb2-9"><a href="#cb2-9"></a>    <span class="co"># Ensure that all energy values are positive, as required for analysis.</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>    <span class="dt">EX.ktoe =</span> <span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(EX.ktoe)</span>
<span id="cb2-11"><a href="#cb2-11"></a>  )</span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(WithNames)</span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt;   Country Year Energy.type Last.stage EX.ktoe Unit matname           rowname</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt; 1      GB 2000      E.ktoe      final   50000 ktoe       R Resources - Crude</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt; 2      GB 2000      E.ktoe      final   50000 ktoe       R Resources - Crude</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; 3      GB 2000      E.ktoe      final   50000 ktoe       R Resources - Crude</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">#&gt; 4      GB 2000      E.ktoe      final   50000 ktoe       R Resources - Crude</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">#&gt; 5      GB 2000      E.ktoe      final   43000 ktoe       R    Resources - NG</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">#&gt; 6      GB 2000      E.ktoe      final   43000 ktoe       R    Resources - NG</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co">#&gt;   colname  rowtype coltype</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co">#&gt; 1   Crude Industry Product</span></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="co">#&gt; 2   Crude Industry Product</span></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="co">#&gt; 3   Crude Industry Product</span></span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="co">#&gt; 4   Crude Industry Product</span></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="co">#&gt; 5      NG Industry Product</span></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="co">#&gt; 6      NG Industry Product</span></span></code></pre></div>
<p>After identifying the matrices, rownames, colnames, rowtypes, and coltypes, we can collapse all data to matrices and add a unit summation matrix (<code>S_units</code>).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>AsMats &lt;-<span class="st"> </span>WithNames <span class="op">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="st">  </span><span class="co"># Collapse to matrices using functions in the matsindf package</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="st">  </span><span class="kw">group_by</span>(Country, Year, Energy.type, Last.stage, matname) <span class="op">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="st">  </span><span class="kw">collapse_to_matrices</span>(<span class="dt">matnames =</span> <span class="st">"matname"</span>, <span class="dt">matvals =</span> <span class="st">"EX.ktoe"</span>,</span>
<span id="cb3-5"><a href="#cb3-5"></a>                       <span class="dt">rownames =</span> <span class="st">"rowname"</span>, <span class="dt">colnames =</span> <span class="st">"colname"</span>,</span>
<span id="cb3-6"><a href="#cb3-6"></a>                       <span class="dt">rowtypes =</span> <span class="st">"rowtype"</span>, <span class="dt">coltypes =</span> <span class="st">"coltype"</span>) <span class="op">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">matrix.name =</span> matname, <span class="dt">matrix =</span> EX.ktoe) <span class="op">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="st">  </span><span class="kw">spread</span>(<span class="dt">key =</span> matrix.name, <span class="dt">value =</span> matrix) <span class="op">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="st">  </span><span class="co"># Do a little more cleanup</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="co"># Create full U matrix</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="dt">U =</span> matsbyname<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/matsbyname/man/sum_byname.html">sum_byname</a></span>(U_excl_EIOU, U_EIOU),</span>
<span id="cb3-13"><a href="#cb3-13"></a>    <span class="co"># Create r_EIOU, a matrix that identifies the ratio of EIOU to other energy consumed.</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>    <span class="dt">r_EIOU =</span> matsbyname<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/matsbyname/man/quotient_byname.html">quotient_byname</a></span>(U_EIOU, U),</span>
<span id="cb3-15"><a href="#cb3-15"></a>    <span class="dt">r_EIOU =</span> matsbyname<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/matsbyname/man/replaceNaN_byname.html">replaceNaN_byname</a></span>(r_EIOU, <span class="dt">val =</span> <span class="dv">0</span>)</span>
<span id="cb3-16"><a href="#cb3-16"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>U_EIOU, <span class="op">-</span>U_excl_EIOU) <span class="op">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="st">  </span><span class="co"># Add S_units matrices</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="st">  </span><span class="kw">left_join</span>(S_units, <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Country"</span>, <span class="st">"Year"</span>, <span class="st">"Energy.type"</span>, <span class="st">"Last.stage"</span>)) <span class="op">%&gt;%</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> matrix.name, <span class="dt">value =</span> matrix, R, U, V, Y, r_EIOU, S_units)</span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="kw"><a href="https://tibble.tidyverse.org/reference/glimpse.html">glimpse</a></span>(AsMats)</span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co">#&gt; Observations: 24</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="co">#&gt; Variables: 6</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="co">#&gt; $ Country     &lt;chr&gt; "GB", "GB", "GB", "GB", "GB", "GB", "GB", "GB", "GB", "GB…</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="co">#&gt; $ Year        &lt;int&gt; 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 200…</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="co">#&gt; $ Energy.type &lt;chr&gt; "E.ktoe", "E.ktoe", "E.ktoe", "X.ktoe", "E.ktoe", "E.ktoe…</span></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="co">#&gt; $ Last.stage  &lt;chr&gt; "final", "services", "useful", "services", "final", "serv…</span></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="co">#&gt; $ matrix.name &lt;chr&gt; "R", "R", "R", "R", "U", "U", "U", "U", "V", "V", "V", "V…</span></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="co">#&gt; $ matrix      &lt;list&gt; [&lt;matrix[2 x 2]&gt;, &lt;matrix[2 x 2]&gt;, &lt;matrix[2 x 2]&gt;, &lt;mat…</span></span></code></pre></div>
<p>The <code>AsMats</code> data frame is essentially the same as the <code><a href="../reference/UKEnergy2000mats.html">Recca::UKEnergy2000mats</a></code> data frame. The remainder of this vignette uses the <code>UKEnergy2000mats</code> data frame.</p>
</div>
<div id="i-o-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#i-o-structure" class="anchor"></a>I-O structure</h2>
<p>(Reference <a href="https://doi.org/10.1016/j.apenergy.2018.05.109">Heun et al. <span class="citation">(2018)</span></a>, Section 2.2.4.)</p>
<div id="with-individual-matrices" class="section level3">
<h3 class="hasAnchor">
<a href="#with-individual-matrices" class="anchor"></a>With individual matrices</h3>
<p>To determine the I-O structure of an ECC, use the <code><a href="../reference/calc_io_mats.html">calc_io_mats()</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyr)</span>
<span id="cb4-2"><a href="#cb4-2"></a>mats &lt;-<span class="st"> </span>UKEnergy2000mats <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span>(<span class="dt">key =</span> matrix.name, <span class="dt">value =</span> matrix) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="st">  </span><span class="co"># Put rows in a natural order</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="dt">Last.stage =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(Last.stage, <span class="dt">levels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"final"</span>, <span class="st">"useful"</span>, <span class="st">"services"</span>)),</span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="dt">Energy.type =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(Energy.type, <span class="dt">levels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"E.ktoe"</span>, <span class="st">"X.ktoe"</span>))</span>
<span id="cb4-8"><a href="#cb4-8"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="st">  </span><span class="kw">arrange</span>(Last.stage, Energy.type) </span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co"># Use the calc_io_mats function with individual matrices, </span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co"># each taken from the first row of the UKEnergy2000mats data frame.</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>U &lt;-<span class="st"> </span>mats<span class="op">$</span>U[[<span class="dv">1</span>]]</span>
<span id="cb4-13"><a href="#cb4-13"></a>V &lt;-<span class="st"> </span>mats<span class="op">$</span>V[[<span class="dv">1</span>]]</span>
<span id="cb4-14"><a href="#cb4-14"></a>Y &lt;-<span class="st"> </span>mats<span class="op">$</span>Y[[<span class="dv">1</span>]]</span>
<span id="cb4-15"><a href="#cb4-15"></a>S_units &lt;-<span class="st"> </span>mats<span class="op">$</span>S_units[[<span class="dv">1</span>]]</span>
<span id="cb4-16"><a href="#cb4-16"></a>IO_list &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc_io_mats.html">calc_io_mats</a></span>(<span class="dt">U =</span> U, <span class="dt">V =</span> V, <span class="dt">Y =</span> Y, <span class="dt">S_units =</span> S_units)</span></code></pre></div>
<p>Most <code>Recca</code> functions return a list when called with individual matrices as arguments. The <code><a href="../reference/calc_io_mats.html">calc_io_mats()</a></code> function gives several I-O matrices in its returned list.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(IO_list)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt; [1] "list"</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(IO_list)</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt;  [1] "y"     "q"     "f"     "g"     "W"     "Z"     "K"     "C"     "D"    </span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt; [10] "A"     "L_pxp" "L_ixp"</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>IO_list[[<span class="st">"y"</span>]]</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt;                Industry</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt; Diesel - Dist.    14750</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt; Elect - Grid       6000</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt; NG - Dist.        25000</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt; Petrol - Dist.    26000</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">#&gt; attr(,"rowtype")</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt; [1] "Product"</span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#&gt; attr(,"coltype")</span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">#&gt; [1] "Industry"</span></span></code></pre></div>
<p>The same calculations can be performed by supplying a named list to <code>Recca</code> functions. In this approach, all original data are returned in the list. So in this case, matrices <span class="math inline">\(\mathbf{U}\)</span>, <span class="math inline">\(\mathbf{V}\)</span>, <span class="math inline">\(\mathbf{Y}\)</span>, and <span class="math inline">\(\mathbf{S_{units}}\)</span> are also returned from the <code><a href="../reference/calc_io_mats.html">calc_io_mats()</a></code> function. When a list is supplied to a <code>Recca</code> function in the <code>.sutmats</code> argument, most other input arguments must be strings that identify the names of appropriate entries in the <code>.sutmats</code> list containing named vectors or matrices. Helpfully, the default values for other input arguments conform to a standard nomenclature. When using the standard nomenclature, most <code>Recca</code> functions can use the default arguments for input and output items in the list.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>IO_from_list &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc_io_mats.html">calc_io_mats</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">U =</span> U, <span class="dt">V =</span> V, <span class="dt">Y =</span> Y, <span class="dt">S_units =</span> S_units))</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(IO_from_list)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt; [1] "list"</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(IO_from_list)</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt;  [1] "U"       "V"       "Y"       "S_units" "y"       "q"       "f"      </span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt;  [8] "g"       "W"       "Z"       "K"       "C"       "D"       "A"      </span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt; [15] "L_pxp"   "L_ixp"</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>IO_from_list[[<span class="st">"y"</span>]]</span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt;                Industry</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt; Diesel - Dist.    14750</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt; Elect - Grid       6000</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#&gt; NG - Dist.        25000</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">#&gt; Petrol - Dist.    26000</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">#&gt; attr(,"rowtype")</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#&gt; [1] "Product"</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">#&gt; attr(,"coltype")</span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">#&gt; [1] "Industry"</span></span></code></pre></div>
</div>
<div id="from-a-matsindf-style-data-frame" class="section level3">
<h3 class="hasAnchor">
<a href="#from-a-matsindf-style-data-frame" class="anchor"></a>From a <code>matsindf</code>-style data frame</h3>
<p>Most <code>Recca</code> functions can also operate on a <code>matsindf</code>-style data frame. (A <code>matsindf</code>-style data frame has matrices in cells of a data frame. See the <code>matsindf</code> package for additional information.) When a data frame is supplied to a <code>Recca</code> function in the <code>.sutmats</code> argument, most other input arguments must be strings that identify the names of appropriate columns in <code>.sutmats</code> containing named vectors or matrices. Helpfully, the default values for other input arguments conform to a standard nomenclature. When using the standard nomenclature, most <code>Recca</code> functions can use the default arguments for input and output columns. This approach yields very clean piped code, as shown below.</p>
<p>To illustrate the above features of <code>Recca</code> functions, we’ll apply the <code>calc_io_mats</code> function to the entire <code>UKEnergy2000mats</code> data frame, calculating appropriate I-O matrices for each row. Used in this way, <code>Recca</code> functions act like specialized <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">dplyr::mutate()</a></code> functions, with new columns added to the right side of the data frame supplied to the <code>.sutmats</code> argument.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>IO_df &lt;-<span class="st"> </span>mats <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/calc_io_mats.html">calc_io_mats</a></span>()</span></code></pre></div>
<p>By inspecting <code>IO_df</code>, we can see, for example, that one <span class="math inline">\(\mathbf{y}\)</span> vector was calculated for each of the four rows of <code>mats</code>. The same is true for all I-O matrices calculated by <code>calc_io_mats</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(IO_df)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#&gt; [1] "data.frame"</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(IO_df)</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt;  [1] "Country"     "Year"        "Energy.type" "Last.stage"  "r_EIOU"     </span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt;  [6] "S_units"     "U"           "V"           "Y"           "y"          </span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt; [11] "q"           "f"           "g"           "W"           "Z"          </span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt; [16] "K"           "C"           "D"           "A"           "L_pxp"      </span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt; [21] "L_ixp"</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="kw"><a href="https://tibble.tidyverse.org/reference/glimpse.html">glimpse</a></span>(IO_df)</span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt; Observations: 4</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">#&gt; Variables: 21</span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">#&gt; $ Country     &lt;chr&gt; "GB", "GB", "GB", "GB"</span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">#&gt; $ Year        &lt;int&gt; 2000, 2000, 2000, 2000</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#&gt; $ Energy.type &lt;fct&gt; E.ktoe, E.ktoe, E.ktoe, X.ktoe</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">#&gt; $ Last.stage  &lt;fct&gt; final, useful, services, services</span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co">#&gt; $ r_EIOU      &lt;list&gt; [&lt;matrix[12 x 9]&gt;, &lt;matrix[13 x 13]&gt;, &lt;matrix[17 x 17]&gt;,…</span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co">#&gt; $ S_units     &lt;list&gt; [&lt;matrix[12 x 1]&gt;, &lt;matrix[16 x 1]&gt;, &lt;matrix[20 x 5]&gt;, &lt;…</span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="co">#&gt; $ U           &lt;list&gt; [&lt;matrix[12 x 9]&gt;, &lt;matrix[13 x 13]&gt;, &lt;matrix[17 x 17]&gt;,…</span></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co">#&gt; $ V           &lt;list&gt; [&lt;matrix[11 x 12]&gt;, &lt;matrix[15 x 16]&gt;, &lt;matrix[19 x 20]&gt;…</span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">#&gt; $ Y           &lt;list&gt; [&lt;matrix[4 x 2]&gt;, &lt;matrix[4 x 2]&gt;, &lt;matrix[4 x 2]&gt;, &lt;mat…</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co">#&gt; $ y           &lt;list&gt; [&lt;matrix[4 x 1]&gt;, &lt;matrix[4 x 1]&gt;, &lt;matrix[4 x 1]&gt;, &lt;mat…</span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">#&gt; $ q           &lt;list&gt; [&lt;matrix[12 x 1]&gt;, &lt;matrix[16 x 1]&gt;, &lt;matrix[20 x 1]&gt;, &lt;…</span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">#&gt; $ f           &lt;list&gt; [&lt;matrix[9 x 1]&gt;, &lt;matrix[13 x 1]&gt;, &lt;matrix[17 x 1]&gt;, &lt;m…</span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co">#&gt; $ g           &lt;list&gt; [&lt;matrix[11 x 1]&gt;, &lt;matrix[15 x 1]&gt;, &lt;matrix[19 x 1]&gt;, &lt;…</span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co">#&gt; $ W           &lt;list&gt; [&lt;matrix[12 x 11]&gt;, &lt;matrix[16 x 15]&gt;, &lt;matrix[20 x 19]&gt;…</span></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="co">#&gt; $ Z           &lt;list&gt; [&lt;matrix[12 x 11]&gt;, &lt;matrix[13 x 15]&gt;, &lt;matrix[17 x 19]&gt;…</span></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="co">#&gt; $ K           &lt;list&gt; [&lt;matrix[12 x 9]&gt;, &lt;matrix[13 x 13]&gt;, NA, NA]</span></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co">#&gt; $ C           &lt;list&gt; [&lt;matrix[12 x 11]&gt;, &lt;matrix[16 x 15]&gt;, &lt;matrix[20 x 19]&gt;…</span></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="co">#&gt; $ D           &lt;list&gt; [&lt;matrix[11 x 12]&gt;, &lt;matrix[15 x 16]&gt;, &lt;matrix[19 x 20]&gt;…</span></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="co">#&gt; $ A           &lt;list&gt; [&lt;matrix[12 x 12]&gt;, &lt;matrix[13 x 16]&gt;, &lt;matrix[17 x 20]&gt;…</span></span>
<span id="cb8-31"><a href="#cb8-31"></a><span class="co">#&gt; $ L_pxp       &lt;list&gt; [&lt;matrix[12 x 12]&gt;, &lt;matrix[16 x 16]&gt;, &lt;matrix[20 x 20]&gt;…</span></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="co">#&gt; $ L_ixp       &lt;list&gt; [&lt;matrix[11 x 12]&gt;, &lt;matrix[15 x 16]&gt;, &lt;matrix[19 x 20]&gt;…</span></span>
<span id="cb8-33"><a href="#cb8-33"></a>IO_df[[<span class="st">"y"</span>]][[<span class="dv">1</span>]]</span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="co">#&gt;                Industry</span></span>
<span id="cb8-35"><a href="#cb8-35"></a><span class="co">#&gt; Diesel - Dist.    14750</span></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="co">#&gt; Elect - Grid       6000</span></span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="co">#&gt; NG - Dist.        25000</span></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="co">#&gt; Petrol - Dist.    26000</span></span>
<span id="cb8-39"><a href="#cb8-39"></a><span class="co">#&gt; attr(,"rowtype")</span></span>
<span id="cb8-40"><a href="#cb8-40"></a><span class="co">#&gt; [1] "Product"</span></span>
<span id="cb8-41"><a href="#cb8-41"></a><span class="co">#&gt; attr(,"coltype")</span></span>
<span id="cb8-42"><a href="#cb8-42"></a><span class="co">#&gt; [1] "Industry"</span></span>
<span id="cb8-43"><a href="#cb8-43"></a>IO_df[[<span class="st">"y"</span>]][[<span class="dv">4</span>]]</span>
<span id="cb8-44"><a href="#cb8-44"></a><span class="co">#&gt;                                 Industry</span></span>
<span id="cb8-45"><a href="#cb8-45"></a><span class="co">#&gt; Freight [tonne-km/year]     1.429166e+11</span></span>
<span id="cb8-46"><a href="#cb8-46"></a><span class="co">#&gt; Illumination [lumen-hrs/yr] 5.000000e+14</span></span>
<span id="cb8-47"><a href="#cb8-47"></a><span class="co">#&gt; Passenger [passenger-km/yr] 5.000000e+11</span></span>
<span id="cb8-48"><a href="#cb8-48"></a><span class="co">#&gt; Space heating [m3-K]        7.500000e+10</span></span>
<span id="cb8-49"><a href="#cb8-49"></a><span class="co">#&gt; attr(,"rowtype")</span></span>
<span id="cb8-50"><a href="#cb8-50"></a><span class="co">#&gt; [1] "Product"</span></span>
<span id="cb8-51"><a href="#cb8-51"></a><span class="co">#&gt; attr(,"coltype")</span></span>
<span id="cb8-52"><a href="#cb8-52"></a><span class="co">#&gt; [1] "Industry"</span></span></code></pre></div>
<p>For the remainder of this vignette, operations will be performed on the entire <code>UKEnergy2000mats</code> data frame. But readers should remember that functions can be called on named lists or individual matrices, as well.</p>
</div>
</div>
<div id="changes-in-final-demand" class="section level2">
<h2 class="hasAnchor">
<a href="#changes-in-final-demand" class="anchor"></a>Changes in final demand</h2>
<p>(Reference <a href="https://doi.org/10.1016/j.apenergy.2018.05.109">Heun et al. <span class="citation">(2018)</span></a>, Section 2.2.5.)</p>
<p>One of the first applications of input-output analysis was estimating changes in industry outputs that would be required to meet new final demand. <code>Recca</code> allows similar calculations on energy conversion chains with the function <code><a href="../reference/new_Y.html">new_Y()</a></code>. Arguments to <code><a href="../reference/new_Y.html">new_Y()</a></code> include matrices that describe the input-output structure of the ECC and <code>Y_prime</code>, the new final demand matrix. <code><a href="../reference/new_Y.html">new_Y()</a></code> calculates <code>U_prime</code> and <code>V_prime</code> matrices which represent the ECC that would be required to meet the new final demand represented by <code>Y_prime</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>Double_demand &lt;-<span class="st"> </span>IO_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb9-3"><a href="#cb9-3"></a>    <span class="dt">Y_prime =</span> <span class="kw">hadamardproduct_byname</span>(<span class="dv">2</span>, Y)</span>
<span id="cb9-4"><a href="#cb9-4"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="st">  </span><span class="kw"><a href="../reference/new_Y.html">new_Y</a></span>()</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(Double_demand)</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt;  [1] "Country"     "Year"        "Energy.type" "Last.stage"  "r_EIOU"     </span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt;  [6] "S_units"     "U"           "V"           "Y"           "y"          </span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt; [11] "q"           "f"           "g"           "W"           "Z"          </span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt; [16] "K"           "C"           "D"           "A"           "L_pxp"      </span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt; [21] "L_ixp"       "Y_prime"     "U_prime"     "V_prime"</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>IO_df[[<span class="st">"Y"</span>]][[<span class="dv">1</span>]][ , <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt;                Residential Transport</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt; Diesel - Dist.           0     14750</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt; Elect - Grid          6000         0</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt; NG - Dist.           25000         0</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">#&gt; Petrol - Dist.           0     26000</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>Double_demand[[<span class="st">"Y_prime"</span>]][[<span class="dv">1</span>]]</span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">#&gt;                Residential Transport</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">#&gt; Diesel - Dist.           0     29500</span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co">#&gt; Elect - Grid         12000         0</span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co">#&gt; NG - Dist.           50000         0</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">#&gt; Petrol - Dist.           0     52000</span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">#&gt; attr(,"rowtype")</span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">#&gt; [1] "Product"</span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="co">#&gt; attr(,"coltype")</span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co">#&gt; [1] "Industry"</span></span>
<span id="cb9-28"><a href="#cb9-28"></a>IO_df[[<span class="st">"U"</span>]][[<span class="dv">1</span>]][ , <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Crude dist."</span>, <span class="st">"Diesel dist."</span>)]</span>
<span id="cb9-29"><a href="#cb9-29"></a><span class="co">#&gt;                Crude dist. Diesel dist.</span></span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="co">#&gt; Crude                    0            0</span></span>
<span id="cb9-31"><a href="#cb9-31"></a><span class="co">#&gt; Crude - Dist.          500            0</span></span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="co">#&gt; Crude - Fields       47500            0</span></span>
<span id="cb9-33"><a href="#cb9-33"></a><span class="co">#&gt; Diesel                   0        15500</span></span>
<span id="cb9-34"><a href="#cb9-34"></a><span class="co">#&gt; Diesel - Dist.          25          350</span></span>
<span id="cb9-35"><a href="#cb9-35"></a><span class="co">#&gt; Elect                    0            0</span></span>
<span id="cb9-36"><a href="#cb9-36"></a><span class="co">#&gt; Elect - Grid            25            0</span></span>
<span id="cb9-37"><a href="#cb9-37"></a><span class="co">#&gt; NG                       0            0</span></span>
<span id="cb9-38"><a href="#cb9-38"></a><span class="co">#&gt; NG - Dist.               0            0</span></span>
<span id="cb9-39"><a href="#cb9-39"></a><span class="co">#&gt; NG - Wells               0            0</span></span>
<span id="cb9-40"><a href="#cb9-40"></a><span class="co">#&gt; Petrol                   0            0</span></span>
<span id="cb9-41"><a href="#cb9-41"></a><span class="co">#&gt; Petrol - Dist.           0            0</span></span>
<span id="cb9-42"><a href="#cb9-42"></a>Double_demand[[<span class="st">"U_prime"</span>]][[<span class="dv">1</span>]][ , <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Crude dist."</span>, <span class="st">"Diesel dist."</span>)]</span>
<span id="cb9-43"><a href="#cb9-43"></a><span class="co">#&gt;                Crude dist. Diesel dist.</span></span>
<span id="cb9-44"><a href="#cb9-44"></a><span class="co">#&gt; Crude                    0            0</span></span>
<span id="cb9-45"><a href="#cb9-45"></a><span class="co">#&gt; Crude - Dist.         1000            0</span></span>
<span id="cb9-46"><a href="#cb9-46"></a><span class="co">#&gt; Crude - Fields       95000            0</span></span>
<span id="cb9-47"><a href="#cb9-47"></a><span class="co">#&gt; Diesel                   0        31000</span></span>
<span id="cb9-48"><a href="#cb9-48"></a><span class="co">#&gt; Diesel - Dist.          50          700</span></span>
<span id="cb9-49"><a href="#cb9-49"></a><span class="co">#&gt; Elect                    0            0</span></span>
<span id="cb9-50"><a href="#cb9-50"></a><span class="co">#&gt; Elect - Grid            50            0</span></span>
<span id="cb9-51"><a href="#cb9-51"></a><span class="co">#&gt; NG                       0            0</span></span>
<span id="cb9-52"><a href="#cb9-52"></a><span class="co">#&gt; NG - Dist.               0            0</span></span>
<span id="cb9-53"><a href="#cb9-53"></a><span class="co">#&gt; NG - Wells               0            0</span></span>
<span id="cb9-54"><a href="#cb9-54"></a><span class="co">#&gt; Petrol                   0            0</span></span>
<span id="cb9-55"><a href="#cb9-55"></a><span class="co">#&gt; Petrol - Dist.           0            0</span></span></code></pre></div>
<p>See the vignette for the <a href="new-functions.html"><code>new_*()</code> functions</a> for more details.</p>
</div>
<div id="net-energy-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#net-energy-analysis" class="anchor"></a>Net energy analysis</h2>
<p>(Reference <a href="https://doi.org/10.1016/j.apenergy.2018.05.109">Heun et al. <span class="citation">(2018)</span></a>, Section 3.1.)</p>
<p>The energy production system itself consumes energy, and important metrics for energy conversion chain industries are energy return ratios (ERRs). <code>Recca</code> provides a function to calculate three ERRs, a gross energy ratio (GER), a net energy ratio (NER), and the ratio of NER to GER. GER is commonly called energy return on investment (EROI). (See <a href="https://doi.org/10.3390/en4081211">Brandt &amp; Dale <span class="citation">(2011)</span></a>.) These ERRs can be calculated for a variety of system boundaries. ERRs for the <span class="math inline">\(\gamma\)</span> system boundary can be calculated readily using the <code><a href="../reference/calc_ERRs_gamma.html">calc_ERRs_gamma()</a></code> function. All three ERRs are calculated at the same time. The ERRs are <code>NA</code> for industries in which inputs or outputs are unit-inhomogeneous. The ERRs are <code>Inf</code> for industries that make an energy product without consuming any energy from another processing chain (such as the Elect. grid). The results below are identical to Fig. 6 in <a href="https://doi.org/10.1016/j.apenergy.2018.05.109">Heun et al. <span class="citation">(2018)</span></a>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>ERRs &lt;-<span class="st"> </span>IO_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="st">  </span><span class="kw"><a href="../reference/calc_ERRs_gamma.html">calc_ERRs_gamma</a></span>()</span>
<span id="cb10-3"><a href="#cb10-3"></a>ERRs<span class="op">$</span>ger_gamma[[<span class="dv">1</span>]]</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&gt;                    ger_gamma</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">#&gt; Crude dist.        86.363636</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt; Diesel dist.       44.285714</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; Elect. grid              Inf</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt; Gas wells &amp; proc.  20.722892</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt; NG dist.          820.000000</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt; Oil fields         19.417476</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt; Oil refineries      9.261084</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt; Petrol dist.       35.333333</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#&gt; Power plants       64.000000</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">#&gt; Resources - Crude         NA</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">#&gt; Resources - NG            NA</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">#&gt; attr(,"rowtype")</span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="co">#&gt; [1] "Industry"</span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co">#&gt; attr(,"coltype")</span></span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="co">#&gt; [1] "Product"</span></span>
<span id="cb10-20"><a href="#cb10-20"></a>ERRs<span class="op">$</span>ner_gamma[[<span class="dv">1</span>]]</span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="co">#&gt;                    ner_gamma</span></span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="co">#&gt; Crude dist.        85.363636</span></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="co">#&gt; Diesel dist.       43.285714</span></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co">#&gt; Elect. grid              Inf</span></span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="co">#&gt; Gas wells &amp; proc.  19.722892</span></span>
<span id="cb10-26"><a href="#cb10-26"></a><span class="co">#&gt; NG dist.          819.000000</span></span>
<span id="cb10-27"><a href="#cb10-27"></a><span class="co">#&gt; Oil fields         18.417476</span></span>
<span id="cb10-28"><a href="#cb10-28"></a><span class="co">#&gt; Oil refineries      8.261084</span></span>
<span id="cb10-29"><a href="#cb10-29"></a><span class="co">#&gt; Petrol dist.       34.333333</span></span>
<span id="cb10-30"><a href="#cb10-30"></a><span class="co">#&gt; Power plants       63.000000</span></span>
<span id="cb10-31"><a href="#cb10-31"></a><span class="co">#&gt; Resources - Crude         NA</span></span>
<span id="cb10-32"><a href="#cb10-32"></a><span class="co">#&gt; Resources - NG            NA</span></span>
<span id="cb10-33"><a href="#cb10-33"></a><span class="co">#&gt; attr(,"rowtype")</span></span>
<span id="cb10-34"><a href="#cb10-34"></a><span class="co">#&gt; [1] "Industry"</span></span>
<span id="cb10-35"><a href="#cb10-35"></a><span class="co">#&gt; attr(,"coltype")</span></span>
<span id="cb10-36"><a href="#cb10-36"></a><span class="co">#&gt; [1] "Product"</span></span>
<span id="cb10-37"><a href="#cb10-37"></a>ERRs<span class="op">$</span>r_gamma[[<span class="dv">1</span>]]</span>
<span id="cb10-38"><a href="#cb10-38"></a><span class="co">#&gt;                     r_gamma</span></span>
<span id="cb10-39"><a href="#cb10-39"></a><span class="co">#&gt; Crude dist.       0.9884211</span></span>
<span id="cb10-40"><a href="#cb10-40"></a><span class="co">#&gt; Diesel dist.      0.9774194</span></span>
<span id="cb10-41"><a href="#cb10-41"></a><span class="co">#&gt; Elect. grid             NaN</span></span>
<span id="cb10-42"><a href="#cb10-42"></a><span class="co">#&gt; Gas wells &amp; proc. 0.9517442</span></span>
<span id="cb10-43"><a href="#cb10-43"></a><span class="co">#&gt; NG dist.          0.9987805</span></span>
<span id="cb10-44"><a href="#cb10-44"></a><span class="co">#&gt; Oil fields        0.9485000</span></span>
<span id="cb10-45"><a href="#cb10-45"></a><span class="co">#&gt; Oil refineries    0.8920213</span></span>
<span id="cb10-46"><a href="#cb10-46"></a><span class="co">#&gt; Petrol dist.      0.9716981</span></span>
<span id="cb10-47"><a href="#cb10-47"></a><span class="co">#&gt; Power plants      0.9843750</span></span>
<span id="cb10-48"><a href="#cb10-48"></a><span class="co">#&gt; Resources - Crude        NA</span></span>
<span id="cb10-49"><a href="#cb10-49"></a><span class="co">#&gt; Resources - NG           NA</span></span>
<span id="cb10-50"><a href="#cb10-50"></a><span class="co">#&gt; attr(,"rowtype")</span></span>
<span id="cb10-51"><a href="#cb10-51"></a><span class="co">#&gt; [1] "Industry"</span></span>
<span id="cb10-52"><a href="#cb10-52"></a><span class="co">#&gt; attr(,"coltype")</span></span>
<span id="cb10-53"><a href="#cb10-53"></a><span class="co">#&gt; [1] "Product"</span></span></code></pre></div>
</div>
<div id="efficiencies" class="section level2">
<h2 class="hasAnchor">
<a href="#efficiencies" class="anchor"></a>Efficiencies</h2>
<p>(Reference <a href="https://doi.org/10.1016/j.apenergy.2018.05.109">Heun et al. <span class="citation">(2018)</span></a>, Section 3.2.)</p>
<p>The efficiency of every industry in the ECC can be calculated quickly with the <code><a href="../reference/calc_eta_i.html">calc_eta_i()</a></code> function, which creates a column named <code>eta_i</code> (by default) at the right of the data frame. If a particular ECC has industries whose inputs or outputs are unit inhomogeneous, the <code>eta_i</code> vector will have <code>NA</code> values in the appropriate places. The results below are identical to Fig. 9 in <a href="https://doi.org/10.1016/j.apenergy.2018.05.109">Heun et al. <span class="citation">(2018)</span></a>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>etas &lt;-<span class="st"> </span>IO_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">  </span><span class="kw"><a href="../reference/calc_eta_i.html">calc_eta_i</a></span>()</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(etas)</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt;  [1] "Country"     "Year"        "Energy.type" "Last.stage"  "r_EIOU"     </span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&gt;  [6] "S_units"     "U"           "V"           "Y"           "y"          </span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt; [11] "q"           "f"           "g"           "W"           "Z"          </span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt; [16] "K"           "C"           "D"           "A"           "L_pxp"      </span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt; [21] "L_ixp"       "eta_i"</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>etas[[<span class="st">"eta_i"</span>]][[<span class="dv">1</span>]]</span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt;                       eta_i</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt; Crude dist.       0.9885536</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#&gt; Diesel dist.      0.9779180</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">#&gt; Elect. grid       0.9804688</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">#&gt; Gas wells &amp; proc. 0.9539656</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">#&gt; NG dist.          0.9987820</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">#&gt; Oil fields        0.9510223</span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">#&gt; Oil refineries    0.9025444</span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">#&gt; Petrol dist.      0.9724771</span></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co">#&gt; Power plants      0.3975155</span></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="co">#&gt; Resources - Crude       Inf</span></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="co">#&gt; Resources - NG          Inf</span></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="co">#&gt; attr(,"rowtype")</span></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="co">#&gt; [1] "Industry"</span></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="co">#&gt; attr(,"coltype")</span></span>
<span id="cb11-25"><a href="#cb11-25"></a><span class="co">#&gt; [1] "Product"</span></span>
<span id="cb11-26"><a href="#cb11-26"></a>etas[[<span class="st">"eta_i"</span>]][[<span class="dv">3</span>]] <span class="co"># NAs indicate inhomogeneous units on inputs or outputs.</span></span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="co">#&gt;                       eta_i</span></span>
<span id="cb11-28"><a href="#cb11-28"></a><span class="co">#&gt; Car engines       0.1154000</span></span>
<span id="cb11-29"><a href="#cb11-29"></a><span class="co">#&gt; Cars                     NA</span></span>
<span id="cb11-30"><a href="#cb11-30"></a><span class="co">#&gt; Crude dist.              NA</span></span>
<span id="cb11-31"><a href="#cb11-31"></a><span class="co">#&gt; Diesel dist.             NA</span></span>
<span id="cb11-32"><a href="#cb11-32"></a><span class="co">#&gt; Elect. grid       0.9804688</span></span>
<span id="cb11-33"><a href="#cb11-33"></a><span class="co">#&gt; Furnaces          0.8000000</span></span>
<span id="cb11-34"><a href="#cb11-34"></a><span class="co">#&gt; Gas wells &amp; proc. 0.9518282</span></span>
<span id="cb11-35"><a href="#cb11-35"></a><span class="co">#&gt; Homes                    NA</span></span>
<span id="cb11-36"><a href="#cb11-36"></a><span class="co">#&gt; Light fixtures    0.2000000</span></span>
<span id="cb11-37"><a href="#cb11-37"></a><span class="co">#&gt; NG dist.                 NA</span></span>
<span id="cb11-38"><a href="#cb11-38"></a><span class="co">#&gt; Oil fields        0.9485771</span></span>
<span id="cb11-39"><a href="#cb11-39"></a><span class="co">#&gt; Oil refineries    0.8921933</span></span>
<span id="cb11-40"><a href="#cb11-40"></a><span class="co">#&gt; Petrol dist.             NA</span></span>
<span id="cb11-41"><a href="#cb11-41"></a><span class="co">#&gt; Power plants      0.3975155</span></span>
<span id="cb11-42"><a href="#cb11-42"></a><span class="co">#&gt; Resources - Crude       Inf</span></span>
<span id="cb11-43"><a href="#cb11-43"></a><span class="co">#&gt; Resources - NG          Inf</span></span>
<span id="cb11-44"><a href="#cb11-44"></a><span class="co">#&gt; Rooms                    NA</span></span>
<span id="cb11-45"><a href="#cb11-45"></a><span class="co">#&gt; Truck engines     0.1196000</span></span>
<span id="cb11-46"><a href="#cb11-46"></a><span class="co">#&gt; Trucks                   NA</span></span>
<span id="cb11-47"><a href="#cb11-47"></a><span class="co">#&gt; attr(,"rowtype")</span></span>
<span id="cb11-48"><a href="#cb11-48"></a><span class="co">#&gt; [1] "Industry"</span></span>
<span id="cb11-49"><a href="#cb11-49"></a><span class="co">#&gt; attr(,"coltype")</span></span>
<span id="cb11-50"><a href="#cb11-50"></a><span class="co">#&gt; [1] "Product"</span></span></code></pre></div>
</div>
<div id="energy-footprints" class="section level2">
<h2 class="hasAnchor">
<a href="#energy-footprints" class="anchor"></a>Energy footprints</h2>
<p>(Reference <a href="https://doi.org/10.1016/j.apenergy.2018.05.109">Heun et al. <span class="citation">(2018)</span></a>, Section 3.3.)</p>
<p>Final demand for energy contains embodied primary energy, the sum of all primary energy consumed and wasted throughout the ECC in the process of satisfying that final demand. <code>Recca</code> provides two functions to calculate embodied primary energy and important ratios, namely <code><a href="../reference/calc_embodied_mats.html">calc_embodied_mats()</a></code> and <code><a href="../reference/calc_embodied_etas.html">calc_embodied_etas()</a></code>.</p>
<p>Outputs from <code><a href="../reference/calc_embodied_mats.html">calc_embodied_mats()</a></code> include the following matrices:</p>
<p>The function <code><a href="../reference/calc_embodied_mats.html">calc_embodied_mats()</a></code> calculates embodied energy in final demand products (<span class="math inline">\(p\)</span>) and final demand sectors (<span class="math inline">\(s\)</span>).</p>
<table class="table">
<colgroup>
<col width="7%">
<col width="92%">
</colgroup>
<thead><tr class="header">
<th align="right">Matrix</th>
<th align="left">Description (rows<span class="math inline">\(\times\)</span>columns)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(\mathbf{G} = \underset{\mathrm{i} \times \mathrm{p}}{\mathbf{L}}\widehat{\mathbf{y}}\)</span></td>
<td align="left">Industry output requirements for final demand (i<span class="math inline">\(\times\)</span>p)</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(\mathbf{H} = \underset{\mathrm{i} \times \mathrm{p}}{\mathbf{L}}\mathbf{Y}\)</span></td>
<td align="left">Industry output requirements for final demand sectors (i<span class="math inline">\(\times\)</span>s)</td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(\mathbf{E} = (\mathbf{W} + \mathbf{U}_{EIOU})\widehat{\mathbf{g}}^{\mathrm{-}1}\)</span></td>
<td align="left">Energy or services produced (<span class="math inline">\(+\)</span>) or consumed (<span class="math inline">\(-\)</span>) per unit output by industries (in columns) (p<span class="math inline">\(\times\)</span>i)</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(\mathbf{M}_p\)</span></td>
<td align="left">embodied products <span class="math inline">\(\times\)</span> embodying products</td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(\mathbf{M}_s\)</span></td>
<td align="left">embodied products <span class="math inline">\(\times\)</span> consumed by final demand sectors</td>
</tr>
</tbody>
</table>
<p><code><a href="../reference/calc_embodied_etas.html">calc_embodied_etas()</a></code> also calculates <span class="math inline">\(\mathbf{F}_{footprint}\)</span> and <span class="math inline">\(\mathbf{F}_{effects}\)</span> matrices, which answer the questions (respectively) <code>What is the fractional composition of embodied energy of each final demand energy type?'' and</code>What is the fractional destination of a given upstream energy product?’’ The calculations can be performed for each final demand product or each final demand sector. The following table describes these matrices.</p>
<table class="table">
<colgroup>
<col width="7%">
<col width="92%">
</colgroup>
<thead><tr class="header">
<th align="right">Matrix</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(\mathbf{F}_{footprint,p}\)</span></td>
<td align="left">Each final demand product (columns) contains embodied energy. On a fractional basis, where does that embodied energy come from (rows)? Columns sum to 1.</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(\mathbf{F}_{effects,p}\)</span></td>
<td align="left">Each upstream energy product (rows) becomes embodied somewhere. On a fractional basis, where does that upstream energy become embodied columns)? Rows sums to 1.</td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(\mathbf{F}_{footprint,s}\)</span></td>
<td align="left">Each final demand sector (columns) consumes embodied energy. On a fractional basis, where does the consumed embodied energy come from (rows)? Columns sum to 1.</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(\mathbf{F}_{effects,s}\)</span></td>
<td align="left">Each embodied upstream energy product (rows) is consumed by a final demand sector. On a fractional basis, where is that embodied upstream energy consumed (columns)? Rows sums to 1.</td>
</tr>
</tbody>
</table>
<p>Finally, embodied energy efficiencies can be calculated as final demand energy divided by embodied energy. Again, efficiencies can be calculated for each final demand product or each final demand sector. The <code><a href="../reference/calc_embodied_etas.html">calc_embodied_etas()</a></code> function does this computation.</p>
<table class="table">
<colgroup>
<col width="7%">
<col width="92%">
</colgroup>
<thead><tr class="header">
<th align="right">Matrix</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(\eta_p\)</span></td>
<td align="left">Final demand product (rows) divided by embodied energy of that final demand product</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(\eta_s\)</span></td>
<td align="left">Energy consumed by final demand sector (rows) dividied by embodied energy input to the final demand sector</td>
</tr>
</tbody>
</table>
<!-- These don't work at this time. --><!-- | $\colvec{\bm{\upeta}}_p$ | Final demand product (rows) divided by embodied energy of that final demand product | --><!-- | $\colvec{\bm{\upeta}}_s$ | Energy consumed by final demand sector (rows) dividied by embodied energy input to the final demand sector  | --><div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>primary_machine_names &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Resources - Crude"</span>, <span class="st">"Resources - NG"</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a>embodied_mats &lt;-<span class="st"> </span>IO_df <span class="op">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb12-5"><a href="#cb12-5"></a>    <span class="dt">U_EIOU =</span> <span class="kw">hadamardproduct_byname</span>(r_EIOU, U)</span>
<span id="cb12-6"><a href="#cb12-6"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="st">  </span><span class="kw"><a href="../reference/calc_embodied_mats.html">calc_embodied_mats</a></span>() <span class="op">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="st">  </span><span class="kw"><a href="../reference/calc_embodied_etas.html">calc_embodied_etas</a></span>(<span class="dt">primary_machine_names =</span> primary_machine_names)</span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(embodied_mats)</span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">#&gt;  [1] "Country"       "Year"          "Energy.type"   "Last.stage"   </span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co">#&gt;  [5] "r_EIOU"        "S_units"       "U"             "V"            </span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">#&gt;  [9] "Y"             "y"             "q"             "f"            </span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">#&gt; [13] "g"             "W"             "Z"             "K"            </span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co">#&gt; [17] "C"             "D"             "A"             "L_pxp"        </span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co">#&gt; [21] "L_ixp"         "U_EIOU"        "G"             "H"            </span></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="co">#&gt; [25] "E"             "M_p"           "M_s"           "F_footprint_p"</span></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="co">#&gt; [29] "F_effects_p"   "F_footprint_s" "F_effects_s"   "eta_p"        </span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co">#&gt; [33] "eta_s"</span></span></code></pre></div>
<p>Figure 15 in <a href="https://doi.org/10.1016/j.apenergy.2018.05.109">Heun et al. <span class="citation">(2018)</span></a> shows primary-to-services energetic efficiencies for the ECC in the 3rd row of <code>IO_df</code>. The following code extracts those results. Rows of the vector give final demand services and their units. The column gives efficiencies in units of service per ktoe of energy.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>embodied_mats<span class="op">$</span>eta_p[[<span class="dv">3</span>]]</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">#&gt;                                Industry</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt; Freight [tonne-km/year]         8003565</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt; Illumination [lumen-hrs/yr] 30377575919</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt; Passenger [passenger-km/yr]    15520345</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#&gt; Space heating [m3-K]            2833601</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#&gt; attr(,"rowtype")</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">#&gt; [1] "Product"</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">#&gt; attr(,"coltype")</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">#&gt; [1] "Industry"</span></span></code></pre></div>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p>This vignette demonstrated the use of the <code>Recca</code> package. <code>Recca</code> provides many useful functions for analyzing energy conversion chains within the PSUT framework first described in <a href="https://doi.org/10.1016/j.apenergy.2018.05.109">Heun et al. <span class="citation">(2018)</span></a>.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Brandt:2011">
<p>Brandt, Adam R., and Michael Dale. 2011. “A General Mathematical Framework for Calculating Systems-Scale Efficiency of Energy Extraction and Conversion: Energy Return on Investment (EROI) and Other Energy Return Ratios.” <em>Energies</em> 4: 1211–45. <a href="https://doi.org/10.3390/en4081211">https://doi.org/10.3390/en4081211</a>.</p>
</div>
<div id="ref-Heun:2018">
<p>Heun, Matthew Kuperus, Anne Owen, and Paul E. Brockway. 2018. “A Physical Supply-Use Table Framework for Energy Analysis on the Energy Conversion Chain.” <em>Applied Energy</em> 226 (September): 1134–62. <a href="https://doi.org/10.1016/j.apenergy.2018.05.109">https://doi.org/10.1016/j.apenergy.2018.05.109</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#design-philosophy">Design philosophy</a></li>
      <li><a href="#psut-matrices">PSUT matrices</a></li>
      <li><a href="#i-o-structure">I-O structure</a></li>
      <li><a href="#changes-in-final-demand">Changes in final demand</a></li>
      <li><a href="#net-energy-analysis">Net energy analysis</a></li>
      <li><a href="#efficiencies">Efficiencies</a></li>
      <li><a href="#energy-footprints">Energy footprints</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matthew Heun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
