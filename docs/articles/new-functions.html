<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Recca">
<title>new_* functions • Recca</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="new_* functions">
<meta property="og:description" content="Recca">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Recca</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.55</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/Recca.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Aggregation.html">Aggregation</a>
    <a class="dropdown-item" href="../articles/new-function-interaction.html">new_* function interactions</a>
    <a class="dropdown-item" href="../articles/new-functions.html">new_* functions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MatthewHeun/Recca/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="new-functions_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="new-functions_files/d3-4.5.0/d3.min.js"></script><script src="new-functions_files/sankey-1/sankey.js"></script><script src="new-functions_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>new_* functions</h1>
                        <h4 data-toc-skip class="author">Matthew Kuperus
Heun</h4>
            
            <h4 data-toc-skip class="date">2024-02-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MatthewHeun/Recca/blob/HEAD/vignettes/new-functions.Rmd" class="external-link"><code>vignettes/new-functions.Rmd</code></a></small>
      <div class="d-none name"><code>new-functions.Rmd</code></div>
    </div>

    
    
<!-- Establish some helpful LaTeX shortcuts for equations -->
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>Recca</code> is an <code>R</code> package that builds upon
input-output (I-O) analysis, developed originally to analyze money flow
through economies, to analyze energy conversion chains (ECCs).
Historically, input-output (I-O) analysis has been used to analyze
“what-if” scenarios involving changes to the production structure of an
economy. A common scenario asks “how will the structure of intermediate
industries (represented by <span class="math inline">\(\mathbf{U}\)</span> and <span class="math inline">\(\mathbf{V}\)</span> matrices) change when final
demand (represented by the <span class="math inline">\(\mathbf{Y}\)</span> matrix) changes?” In the
economic arena, Leontief’s early work answered this question via a
matrix inversion that now bears his name, the “Leontief inverse (<span class="math inline">\(\mathbf{L}\)</span>)” <span class="citation">(Leontief 1941)</span>. Analysts with an I-O background
will know the famous equation <span class="math inline">\(\mathbf{L} =
(\mathbf{I} - \mathbf{A})^{-1}\)</span>.</p>
<p>The <code>Recca</code> package provides functions that perform
several “what if” analyses for the analyst. Each function has the name
<code>new_*</code>, where <code>*</code> indicates the changed matrix or
portion of the ECC. Some functions have the suffix <code>_ps</code> to
indicate the functions assume perfect substitution (<code>ps</code>) of
industry inputs throughout the ECC. The <code>new_*</code> functions
return the resource (<span class="math inline">\(\mathbf{R}\)</span>),
use (<span class="math inline">\(\mathbf{U}\)</span>), make (<span class="math inline">\(\mathbf{V}\)</span>), and final demand (<span class="math inline">\(\mathbf{Y}\)</span>) matrices that would be
present under the conditions given by arguments to the
<code>new_*</code> functions. Arguments for new or changed versions of
vectors or matrices are given the suffix <code>_prime</code> in the
<code>new_*</code> functions. For example, the changed version of the
use matrix (<span class="math inline">\(\mathbf{U}\)</span>) is called
<code>U_prime</code>.</p>
<p>For the examples that follow, we’ll use one ECC from the
<code>UKEnergy2000mats</code> data frame which represents a portion of
the primary and final energy flows through the UK in the year 2000.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MatthewHeun/matsbyname" class="external-link">matsbyname</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MatthewHeun/matsindf" class="external-link">matsindf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MatthewHeun/Recca" class="external-link">Recca</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="va">OurECC</span> <span class="op">&lt;-</span> <span class="va">UKEnergy2000mats</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Last.stage</span> <span class="op">==</span> <span class="st">"Final"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"matrix.name"</span>, value <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">OurECC</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1</span></span>
<span><span class="co">#&gt; Columns: 12</span></span>
<span><span class="co">#&gt; $ Country     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GBR"</span></span>
<span><span class="co">#&gt; $ Year        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2000</span></span>
<span><span class="co">#&gt; $ Energy.type <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E"</span></span>
<span><span class="co">#&gt; $ Last.stage  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final"</span></span>
<span><span class="co">#&gt; $ R           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 2]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r_EIOU      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ S_units     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_EIOU      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 8]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_feed      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ V           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 10]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Y           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[4 x 2]&gt;&gt;</span></span></code></pre></div>
<p>After a short discussion of the inputs to the <code>new_*</code>
functions, each type of analysis is described in turn.</p>
</div>
<div class="section level2">
<h2 id="inputs-to-new_-functions">Inputs to <code>new_*</code> functions<a class="anchor" aria-label="anchor" href="#inputs-to-new_-functions"></a>
</h2>
<p>Inputs to the <code>new_*</code> functions include matrices that
describe the ECC and matrices that describe the input-output structure
of the ECC.</p>
<div class="section level3">
<h3 id="matrices-that-describe-the-ecc">Matrices that describe the ECC<a class="anchor" aria-label="anchor" href="#matrices-that-describe-the-ecc"></a>
</h3>
<p>The <code>new_*</code> functions take as inputs resource (<span class="math inline">\(\mathbf{R}\)</span>), use (<span class="math inline">\(\mathbf{U}\)</span>), make (<span class="math inline">\(\mathbf{V}\)</span>), and final demand (<span class="math inline">\(\mathbf{Y}\)</span>) matrices that describe the
ECC.</p>
<p>To look at the ECC, we can draw a Sankey diagram. A Sankey diagram
for the first row of the <code>UKEnergyMatsWithR</code> data frame is
given below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_sankey.html">make_sankey</a></span><span class="op">(</span><span class="va">OurECC</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"Sankey"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># Extracts the "Sankey" column</span></span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Extracts the first row of the "Sankey" column</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-5673976f86ad9f96f105" style="width:672px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-5673976f86ad9f96f105">{"x":{"links":{"source":[0,1,1,2,2,3,3,4,4,4,4,4,4,4,5,6,6,6,6,6,6,6,7,8,8,9,9,3,10,10,1,4,6,9,8,2,3,10,5],"target":[2,1,3,1,2,4,3,1,4,9,8,2,10,11,6,1,9,8,2,3,5,12,9,5,12,9,8,10,10,11,13,13,13,13,13,13,13,13,13],"value":[50000,500,47000,47500,2500,15500,5000,25,350,50,25,50,250,14750,6400,25,25,25,25,75,100,6000,43000,16000,25000,2000,41000,26500,500,26000,550,350,125,2075,50,2575,5075,750,9700]},"nodes":{"name":["Resources [of Crude]","Crude dist.","Oil fields","Oil refineries","Diesel dist.","Power plants","Elect. grid","Resources [of NG]","NG dist.","Gas wells & proc.","Petrol dist.","Transport","Residential","Waste"],"group":["Resources [of Crude]","Crude dist.","Oil fields","Oil refineries","Diesel dist.","Power plants","Elect. grid","Resources [of NG]","NG dist.","Gas wells & proc.","Petrol dist.","Transport","Residential","Waste"]},"options":{"NodeID":"Node","NodeGroup":"Node","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="matrices-that-describe-the-input-output-structure-of-the-ecc">Matrices that describe the input-output structure of the ECC<a class="anchor" aria-label="anchor" href="#matrices-that-describe-the-input-output-structure-of-the-ecc"></a>
</h3>
<p>Each <code>new_*</code> function requires basic knowledge about the
I-O structure of the ECCs in the form of named vectors and matrices.
Thus, the first step in any “what-if” analysis is to calculate the
input-output structure of the energy conversion chain. The
<code><a href="../reference/calc_io_mats.html">calc_io_mats()</a></code> function is the simplest way to obtain the
necessary I-O structure, which appears as additional columns appended at
the right of the <code>OurECC</code> data frame in our example. (The
names of the additional columns are given by arguments to the
<code><a href="../reference/calc_io_mats.html">calc_io_mats()</a></code> function.)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IO_mats</span> <span class="op">&lt;-</span> <span class="va">OurECC</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Obtain the I-O structure of the ECCs</span></span>
<span>  <span class="fu"><a href="../reference/calc_io_mats.html">calc_io_mats</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Note additional columns appended to the data frame.</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">IO_mats</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1</span></span>
<span><span class="co">#&gt; Columns: 32</span></span>
<span><span class="co">#&gt; $ Country     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GBR"</span></span>
<span><span class="co">#&gt; $ Year        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2000</span></span>
<span><span class="co">#&gt; $ Energy.type <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E"</span></span>
<span><span class="co">#&gt; $ Last.stage  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final"</span></span>
<span><span class="co">#&gt; $ R           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 2]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r_EIOU      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ S_units     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_EIOU      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 8]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_feed      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ V           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 10]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Y           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[4 x 2]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ y           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[4 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ q           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ f           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ g           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ h           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ W           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Z           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ K           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ C           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[10 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ D           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 12]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ A           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 12]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ O           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 2]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_pxp       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 12]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_ixp       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 12]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Z_feed      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ K_feed      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ A_feed      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 12]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_pxp_feed  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 12]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_ixp_feed  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 12]&gt;&gt;</span></span></code></pre></div>
<p>With the I-O structure of the ECC determined (and represented by the
<span class="math inline">\(\mathbf{q}\)</span>, <span class="math inline">\(\mathbf{f}\)</span>, <span class="math inline">\(\mathbf{h}\)</span>, <span class="math inline">\(\mathbf{r}\)</span> and <span class="math inline">\(\mathbf{g}\)</span> vectors and the <span class="math inline">\(\mathbf{W}\)</span>, <span class="math inline">\(\mathbf{Z}\)</span>, <span class="math inline">\(\mathbf{K}\)</span>, <span class="math inline">\(\mathbf{C}\)</span>, <span class="math inline">\(\mathbf{D}\)</span>, , <span class="math inline">\(\mathbf{A}\)</span>, <span class="math inline">\(\mathbf{L_{pxp}}\)</span>, and <span class="math inline">\(\mathbf{L_{ixp}}\)</span> matrices), we can use
the <code>new_*</code> functions to ask “what if” questions.</p>
</div>
</div>
<div class="section level2">
<h2 id="what-if-final-demand-changes-function-new_y">What if final demand changes? Function new_Y()<a class="anchor" aria-label="anchor" href="#what-if-final-demand-changes-function-new_y"></a>
</h2>
<p>The classic I-O question is “what if final demand (<span class="math inline">\(\mathbf{Y}\)</span>) changes?” <code>Recca</code>
has a function for that: <code><a href="../reference/new_Y.html">new_Y()</a></code>. The <code><a href="../reference/new_Y.html">new_Y()</a></code>
function looks upstream in the ECC to determine the effects of a change
in final demand. To demonstrate, we’ll double the
<code>Residential</code> final demand for electricity from the grid
(<code>Elect - Grid</code>) in our ECC.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">double</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fl">2</span><span class="op">*</span><span class="va">x</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">DoubleRes</span> <span class="op">&lt;-</span> <span class="va">IO_mats</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Y_prime <span class="op">=</span> <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/elementapply_byname.html" class="external-link">elementapply_byname</a></span><span class="op">(</span><span class="va">double</span>, a <span class="op">=</span> <span class="va">Y</span>, row <span class="op">=</span> <span class="st">"Elect [from Grid]"</span>, col <span class="op">=</span> <span class="st">"Residential"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">DoubleRes</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                     Residential Transport</span></span>
<span><span class="co">#&gt; Diesel [from Dist.]           0     14750</span></span>
<span><span class="co">#&gt; Elect [from Grid]          6000         0</span></span>
<span><span class="co">#&gt; NG [from Dist.]           25000         0</span></span>
<span><span class="co">#&gt; Petrol [from Dist.]           0     26000</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="va">DoubleRes</span><span class="op">$</span><span class="va">Y_prime</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                     Residential Transport</span></span>
<span><span class="co">#&gt; Diesel [from Dist.]           0     14750</span></span>
<span><span class="co">#&gt; Elect [from Grid]         12000         0</span></span>
<span><span class="co">#&gt; NG [from Dist.]           25000         0</span></span>
<span><span class="co">#&gt; Petrol [from Dist.]           0     26000</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span></code></pre></div>
<p>Now we can use the <code><a href="../reference/new_Y.html">new_Y()</a></code> function to estimate the ECC
with the larger final demand for residential electricity. The original
Sankey diagram is:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_sankey.html">make_sankey</a></span><span class="op">(</span><span class="va">OurECC</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"Sankey"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># Extracts the "Sankey" column</span></span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>            <span class="co"># Extracts the first row of the "Sankey" column</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-1c2b86b24add8af07ddd" style="width:672px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-1c2b86b24add8af07ddd">{"x":{"links":{"source":[0,1,1,2,2,3,3,4,4,4,4,4,4,4,5,6,6,6,6,6,6,6,7,8,8,9,9,3,10,10,1,4,6,9,8,2,3,10,5],"target":[2,1,3,1,2,4,3,1,4,9,8,2,10,11,6,1,9,8,2,3,5,12,9,5,12,9,8,10,10,11,13,13,13,13,13,13,13,13,13],"value":[50000,500,47000,47500,2500,15500,5000,25,350,50,25,50,250,14750,6400,25,25,25,25,75,100,6000,43000,16000,25000,2000,41000,26500,500,26000,550,350,125,2075,50,2575,5075,750,9700]},"nodes":{"name":["Resources [of Crude]","Crude dist.","Oil fields","Oil refineries","Diesel dist.","Power plants","Elect. grid","Resources [of NG]","NG dist.","Gas wells & proc.","Petrol dist.","Transport","Residential","Waste"],"group":["Resources [of Crude]","Crude dist.","Oil fields","Oil refineries","Diesel dist.","Power plants","Elect. grid","Resources [of NG]","NG dist.","Gas wells & proc.","Petrol dist.","Transport","Residential","Waste"]},"options":{"NodeID":"Node","NodeGroup":"Node","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>The new Sankey diagram is:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DoubleRes</span> <span class="op">&lt;-</span> <span class="va">DoubleRes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/new_Y.html">new_Y</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/make_sankey.html">make_sankey</a></span><span class="op">(</span><span class="va">DoubleRes</span>, R <span class="op">=</span> <span class="st">"R_prime"</span>, U <span class="op">=</span> <span class="st">"U_prime"</span>, V <span class="op">=</span> <span class="st">"V_prime"</span>, Y <span class="op">=</span> <span class="st">"Y_prime"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"Sankey"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-c91b030b42ec03c6f261" style="width:672px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-c91b030b42ec03c6f261">{"x":{"links":{"source":[0,1,1,2,2,3,3,4,4,4,4,4,4,4,5,6,6,6,6,6,6,6,7,8,8,9,9,3,10,10,1,4,6,9,8,2,3,10,5],"target":[2,1,3,1,2,4,3,1,4,9,8,2,10,11,6,1,9,8,2,3,5,12,9,5,12,9,8,10,10,11,13,13,13,13,13,13,13,13,13],"value":[50034.81179449566,500.3481179449565,47032.72308682592,47533.07120477087,2501.740589724783,15529.24190737635,5003.481179449566,25.01740589724783,350.6603011343047,69.01959236687067,34.50979618343535,50.03481179449566,250,14750,12638.42629633359,25.01740589724783,34.50979618343533,34.50979618343535,25.01740589724783,75.05221769174349,197.4754108802123,12000,59356.84943550877,31596.06574083396,25000,2760.783694674827,56596.06574083397,26500,500.0000000000001,26000,550.3829297394548,350.660301134305,246.8442636002655,2864.313083225126,69.01959236687253,2576.792807416524,5078.533397141309,750,19155.11485538059]},"nodes":{"name":["Resources [of Crude]","Crude dist.","Oil fields","Oil refineries","Diesel dist.","Power plants","Elect. grid","Resources [of NG]","NG dist.","Gas wells & proc.","Petrol dist.","Transport","Residential","Waste"],"group":["Resources [of Crude]","Crude dist.","Oil fields","Oil refineries","Diesel dist.","Power plants","Elect. grid","Resources [of NG]","NG dist.","Gas wells & proc.","Petrol dist.","Transport","Residential","Waste"]},"options":{"NodeID":"Node","NodeGroup":"Node","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>Output from the electricity grid is clearly larger now than before.
Also, upstream demand for natural gas is now larger than the upstream
demand for crude, whereas in the original Sankey diagram, demand for
crude was larger than the demand for natural gas.</p>
</div>
<div class="section level2">
<h2 id="what-if-resources-change-function-new_r_ps">What if resources change? Function new_R_ps()<a class="anchor" aria-label="anchor" href="#what-if-resources-change-function-new_r_ps"></a>
</h2>
<p><code><a href="../reference/new_Y.html">new_Y()</a></code> estimates the upstream effects of a change to
final demand. But what if we want to understand the downstream effects
of a change in resource availability? The function
<code><a href="../reference/new_R_ps.html">new_R_ps()</a></code> supplies the answer. <code><a href="../reference/new_R_ps.html">new_R_ps()</a></code>
takes as input the input-output structure of an ECC and the efficiency
of every intermediate industry. After discussing the resource matrix and
resource vectors, the <code><a href="../reference/new_R_ps.html">new_R_ps()</a></code> function is
demonstrated.</p>
<div class="section level3">
<h3 id="resource-matrices-and-vectors">Resource matrices and vectors<a class="anchor" aria-label="anchor" href="#resource-matrices-and-vectors"></a>
</h3>
<p>The rate of resource extraction is given by the <span class="math inline">\(\mathbf{R}\)</span> matrix or by the <span class="math inline">\(\mathbf{r}\)</span> vector. The resource matrix
(<span class="math inline">\(\mathbf{R}\)</span>) is Industry<span class="math inline">\(\times\)</span>Product. Its industries are usually
named <code>Resources - &lt;Product&gt;</code>, where
<code>&lt;Product&gt;</code> is the name of the Product produced by that
industry. (<code><a href="https://matthewheun.github.io/matsbyname/reference/clean_byname.html" class="external-link">clean_byname()</a></code> removes <code>0</code> rows and
columns for clarity.)</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">OurECC</span><span class="op">$</span><span class="va">R</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/clean_byname.html" class="external-link">clean_byname</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                      Crude    NG</span></span>
<span><span class="co">#&gt; Resources [of Crude] 50000     0</span></span>
<span><span class="co">#&gt; Resources [of NG]        0 43000</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span></code></pre></div>
<p>The resource vector (<span class="math inline">\(\mathbf{r}\)</span>)
is a Product column vector containing Products that are resources.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rvecs</span> <span class="op">&lt;-</span> <span class="va">OurECC</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html" class="external-link">transmute</a></span><span class="op">(</span></span>
<span>    r <span class="op">=</span> <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/clean_byname.html" class="external-link">clean_byname</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/colsums_byname.html" class="external-link">colsums_byname</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/transpose_byname.html" class="external-link">transpose_byname</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">rvecs</span><span class="op">$</span><span class="va">r</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;       Industry</span></span>
<span><span class="co">#&gt; Crude    50000</span></span>
<span><span class="co">#&gt; NG       43000</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="industry-efficiencies-and-a-new-resource-matrix">Industry efficiencies and a new resource matrix<a class="anchor" aria-label="anchor" href="#industry-efficiencies-and-a-new-resource-matrix"></a>
</h3>
<p>The baseline <span class="math inline">\(\mathbf{R}\)</span> matrix
is shown above. Let’s say we want to estimate the effect of a 50 %
reduction in the production rate of crude oil. So, we cut
<code>Resources - Crude</code> in half. To execute this reduction, we’ll
use the <code><a href="https://matthewheun.github.io/matsbyname/reference/elementapply_byname.html" class="external-link">matsbyname::elementapply_byname()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">half</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">/</span><span class="fl">2</span></span>
<span><span class="op">}</span></span>
<span><span class="va">HalfCrude</span> <span class="op">&lt;-</span> <span class="va">OurECC</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Obtain the I-O structure of the ECCs</span></span>
<span>  <span class="fu"><a href="../reference/calc_io_mats.html">calc_io_mats</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"downstream"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    R_prime <span class="op">=</span> <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/elementapply_byname.html" class="external-link">elementapply_byname</a></span><span class="op">(</span><span class="va">half</span>, a <span class="op">=</span> <span class="va">R</span>, row <span class="op">=</span> <span class="st">"Resources [of Crude]"</span>, col <span class="op">=</span> <span class="st">"Crude"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">HalfCrude</span><span class="op">$</span><span class="va">R_prime</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/clean_byname.html" class="external-link">clean_byname</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                      Crude    NG</span></span>
<span><span class="co">#&gt; Resources [of Crude] 25000     0</span></span>
<span><span class="co">#&gt; Resources [of NG]        0 43000</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span></code></pre></div>
<p>Now we use the <code>new_R()</code> function to estimate changes in
the ECC. But first, we need to calculate the efficiency of all sectors
in the ECC using the <code><a href="../reference/calc_eta_i.html">calc_eta_i()</a></code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HalfCrude</span> <span class="op">&lt;-</span> <span class="va">HalfCrude</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/calc_eta_i.html">calc_eta_i</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/new_R_ps.html">new_R_ps</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">HalfCrude</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1</span></span>
<span><span class="co">#&gt; Columns: 35</span></span>
<span><span class="co">#&gt; $ Country      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GBR"</span></span>
<span><span class="co">#&gt; $ Year         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2000</span></span>
<span><span class="co">#&gt; $ Energy.type  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E"</span></span>
<span><span class="co">#&gt; $ Last.stage   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final"</span></span>
<span><span class="co">#&gt; $ R            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 2]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r_EIOU       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ S_units      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_EIOU       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 8]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_feed       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ V            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 10]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Y            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[4 x 2]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ y            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[4 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ q            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ f            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ g            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ h            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ W            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Z_s          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[10 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ C_s          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ D_s          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 12]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ D_feed_s     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 12]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ O_s          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 2]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ B            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[10 x 12]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ G_pxp        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 12]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ G_ixp        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 12]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ R_prime      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 2]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ eta_i        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_prime      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_feed_prime <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_EIOU_prime <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r_EIOU_prime <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ V_prime      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 10]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Y_prime      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 2]&gt;&gt;</span></span></code></pre></div>
<p>After re-calculating the <code>HalfCrude</code> ECC (specifically,
after calculating <code>U_prime</code>, <code>V_prime</code>, and
<code>Y_prime</code>), we can visualize the effect of lower crude oil
availability with a modified Sankey diagram.</p>
<p>First, we have the original Sankey diagram.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_sankey.html">make_sankey</a></span><span class="op">(</span><span class="va">OurECC</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"Sankey"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># Extracts the "Sankey" column</span></span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Extracts the first row of the "Sankey" column</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-6c5329896bcabf7a2f50" style="width:672px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-6c5329896bcabf7a2f50">{"x":{"links":{"source":[0,1,1,2,2,3,3,4,4,4,4,4,4,4,5,6,6,6,6,6,6,6,7,8,8,9,9,3,10,10,1,4,6,9,8,2,3,10,5],"target":[2,1,3,1,2,4,3,1,4,9,8,2,10,11,6,1,9,8,2,3,5,12,9,5,12,9,8,10,10,11,13,13,13,13,13,13,13,13,13],"value":[50000,500,47000,47500,2500,15500,5000,25,350,50,25,50,250,14750,6400,25,25,25,25,75,100,6000,43000,16000,25000,2000,41000,26500,500,26000,550,350,125,2075,50,2575,5075,750,9700]},"nodes":{"name":["Resources [of Crude]","Crude dist.","Oil fields","Oil refineries","Diesel dist.","Power plants","Elect. grid","Resources [of NG]","NG dist.","Gas wells & proc.","Petrol dist.","Transport","Residential","Waste"],"group":["Resources [of Crude]","Crude dist.","Oil fields","Oil refineries","Diesel dist.","Power plants","Elect. grid","Resources [of NG]","NG dist.","Gas wells & proc.","Petrol dist.","Transport","Residential","Waste"]},"options":{"NodeID":"Node","NodeGroup":"Node","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>And here is the modified Sankey diagram showing the much smaller
<code>Resources - Crude</code> extraction rate.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_sankey.html">make_sankey</a></span><span class="op">(</span><span class="va">HalfCrude</span>, R <span class="op">=</span> <span class="st">"R_prime"</span>, U <span class="op">=</span> <span class="st">"U_prime"</span>, V <span class="op">=</span> <span class="st">"V_prime"</span>, Y <span class="op">=</span> <span class="st">"Y_prime"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"Sankey"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># Extracts the "Sankey" column</span></span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Extracts the first row of the "Sankey" column</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-4f73d92d1b242af3b134" style="width:672px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-4f73d92d1b242af3b134">{"x":{"links":{"source":[0,1,1,2,2,3,3,4,4,4,4,4,4,4,5,6,6,6,6,6,6,6,7,8,8,9,9,3,10,10,1,4,6,9,8,2,3,10,5],"target":[2,1,3,1,2,4,3,1,4,9,8,2,10,11,6,1,9,8,2,3,5,12,9,5,12,9,8,10,10,11,13,13,13,13,13,13,13,13,13],"value":[25000,250.2566658155587,23524.12658666252,23761.89829934845,1250.626226281497,7770.269478469545,2506.538541441789,12.53269270720894,175.4576979009252,25.06538541441789,12.53269270720894,25.06538541441789,125.3269270720894,7394.288697253278,6394.349313017655,24.97792700397521,24.97792700397521,24.97792700397521,24.97792700397521,74.93378101192565,99.91170801590086,5994.702480954052,42999.99999999999,15985.87328254413,24977.92700397521,1998.841244917859,40976.2455208161,13284.65426964149,250.6538541441791,13034.00041549731,275.2823323971121,175.4576979009253,124.8896350198756,2073.797791602279,49.95585400794516,1288.14501306994,2544.136619563416,375.980781216269,9691.43567754238]},"nodes":{"name":["Resources [of Crude]","Crude dist.","Oil fields","Oil refineries","Diesel dist.","Power plants","Elect. grid","Resources [of NG]","NG dist.","Gas wells & proc.","Petrol dist.","Transport","Residential","Waste"],"group":["Resources [of Crude]","Crude dist.","Oil fields","Oil refineries","Diesel dist.","Power plants","Elect. grid","Resources [of NG]","NG dist.","Gas wells & proc.","Petrol dist.","Transport","Residential","Waste"]},"options":{"NodeID":"Node","NodeGroup":"Node","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>The Sankey diagrams clearly show that reducing the availability of
crude oil (<code>Resources - crude</code>) means that less
<code>Transport</code> final demand can be satisfied.</p>
<p>Note that both ECCs are in complete energy balance.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">OurECC</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/verify_SUT_energy_balance_with_units.html">verify_SUT_energy_balance_with_units</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Country</span>, <span class="va">Year</span>, <span class="va">Energy.type</span>, <span class="va">Last.stage</span>, </span>
<span>         <span class="va">.SUT_prod_energy_balance</span>, <span class="va">.SUT_ind_energy_balance</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1</span></span>
<span><span class="co">#&gt; Columns: 6</span></span>
<span><span class="co">#&gt; $ Country                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GBR"</span></span>
<span><span class="co">#&gt; $ Year                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2000</span></span>
<span><span class="co">#&gt; $ Energy.type              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E"</span></span>
<span><span class="co">#&gt; $ Last.stage               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final"</span></span>
<span><span class="co">#&gt; $ .SUT_prod_energy_balance <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> TRUE</span></span>
<span><span class="co">#&gt; $ .SUT_ind_energy_balance  <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HalfCrude</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    R_plus_V_prime <span class="op">=</span> <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/sum_byname.html" class="external-link">sum_byname</a></span><span class="op">(</span><span class="va">R_prime</span>, <span class="va">V_prime</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/verify_SUT_energy_balance.html">verify_SUT_energy_balance</a></span><span class="op">(</span>R <span class="op">=</span> <span class="st">"R_prime"</span>, U <span class="op">=</span> <span class="st">"U_prime"</span>, V <span class="op">=</span> <span class="st">"V_prime"</span>, </span>
<span>                            Y <span class="op">=</span> <span class="st">"Y_prime"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Country</span>, <span class="va">Year</span>, <span class="va">Energy.type</span>, <span class="va">Last.stage</span>,</span>
<span>         <span class="va">.SUT_energy_balance</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1</span></span>
<span><span class="co">#&gt; Columns: 5</span></span>
<span><span class="co">#&gt; $ Country             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GBR"</span></span>
<span><span class="co">#&gt; $ Year                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2000</span></span>
<span><span class="co">#&gt; $ Energy.type         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E"</span></span>
<span><span class="co">#&gt; $ Last.stage          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final"</span></span>
<span><span class="co">#&gt; $ .SUT_energy_balance <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> TRUE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="what-if-perfectly-substitutable-inputs-to-an-intermediate-industry-change-function-new_k_ps">What if perfectly-substitutable inputs to an intermediate industry
change? Function new_k_ps()<a class="anchor" aria-label="anchor" href="#what-if-perfectly-substitutable-inputs-to-an-intermediate-industry-change-function-new_k_ps"></a>
</h2>
<p><code><a href="../reference/new_Y.html">new_Y()</a></code> estimates the upstream effects of a change in
final demand. <code><a href="../reference/new_R_ps.html">new_R_ps()</a></code> estimates the downstream effects
of a change in resource availability. But what if we want to estimate
the effects of a change to the inputs of an intermediate industry? If
those inputs are perfectly substitutable, the <code><a href="../reference/new_k_ps.html">new_k_ps()</a></code>
function provides an answer.</p>
<p>To demonstrate <code><a href="../reference/new_k_ps.html">new_k_ps()</a></code>, we need an ECC that has at
least two reasonably-sized inputs. Unfortunately, <code>OurECC</code>
doesn’t have the necessary characteristics, so we create a new ECC
here.</p>
<p>ECC below has two resource industries (R1 and R2), one intermediate
industry (I), and two final demand sectors (Y1 and Y2). The R1 industry
makes product R1p.<br>
The R2 industry makes product R2p. Industry I makes product Ip. Product
Ip is consumed by final demand sectors Y1 and Y2.</p>
<p>The use (<span class="math inline">\(\mathbf{U}\)</span>), make
(<span class="math inline">\(\mathbf{V}\)</span>), final demand (<span class="math inline">\(\mathbf{Y}\)</span>), and unit summation (<span class="math inline">\(\mathbf{S}_{units}\)</span>) matrices are given
below.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">U</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">10</span>,</span>
<span>              <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">10</span>,</span>
<span>              <span class="fl">0</span>, <span class="fl">0</span>,  <span class="fl">0</span><span class="op">)</span>,</span>
<span>            byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span>,</span>
<span>            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R1p"</span>, <span class="st">"R2p"</span>, <span class="st">"Ip"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R1"</span>, <span class="st">"R2"</span>, <span class="st">"I"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/setrowtype.html" class="external-link">setrowtype</a></span><span class="op">(</span><span class="st">"Products"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/setcoltype.html" class="external-link">setcoltype</a></span><span class="op">(</span><span class="st">"Industries"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># There is no EIOU, so U_feed is the same as U</span></span>
<span><span class="va">U_feed</span> <span class="op">&lt;-</span> <span class="va">U</span></span>
<span></span>
<span><span class="va">R_plus_V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,  <span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>               <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0</span>, </span>
<span>               <span class="fl">0</span>,  <span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>, </span>
<span>            byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span>, </span>
<span>            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R1"</span>, <span class="st">"R2"</span>, <span class="st">"I"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R1p"</span>, <span class="st">"R2p"</span>, <span class="st">"Ip"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/setrowtype.html" class="external-link">setrowtype</a></span><span class="op">(</span><span class="st">"Industries"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/setcoltype.html" class="external-link">setcoltype</a></span><span class="op">(</span><span class="st">"Products"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>              <span class="fl">0</span>, <span class="fl">0</span>, </span>
<span>              <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>            byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R1p"</span>, <span class="st">"R2p"</span>, <span class="st">"Ip"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/setrowtype.html" class="external-link">setrowtype</a></span><span class="op">(</span><span class="st">"Products"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/setcoltype.html" class="external-link">setcoltype</a></span><span class="op">(</span><span class="st">"Industries"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">RV</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/separate_RV.html">separate_RV</a></span><span class="op">(</span>U <span class="op">=</span> <span class="va">U</span>, R_plus_V <span class="op">=</span> <span class="va">R_plus_V</span><span class="op">)</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="va">RV</span><span class="op">$</span><span class="va">R</span></span>
<span><span class="va">V</span> <span class="op">&lt;-</span> <span class="va">RV</span><span class="op">$</span><span class="va">V</span></span>
<span></span>
<span><span class="va">S_units</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, </span>
<span>                    <span class="fl">1</span>, </span>
<span>                    <span class="fl">1</span><span class="op">)</span>, </span>
<span>                  byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R1p"</span>, <span class="st">"R2p"</span>, <span class="st">"Ip"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"quad"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/setrowtype.html" class="external-link">setrowtype</a></span><span class="op">(</span><span class="st">"Products"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/setcoltype.html" class="external-link">setcoltype</a></span><span class="op">(</span><span class="st">"Units"</span><span class="op">)</span></span></code></pre></div>
<p>The Sankey diagram for this simple ECC is given below.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_sankey.html">make_sankey</a></span><span class="op">(</span>R <span class="op">=</span> <span class="va">R</span>, U <span class="op">=</span> <span class="va">U</span>, V <span class="op">=</span> <span class="va">V</span>, Y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"Sankey"</span><span class="op">)</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-8f840752c1563d59c5b2" style="width:672px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-8f840752c1563d59c5b2">{"x":{"links":{"source":[0,0,1,2],"target":[3,4,0,0],"value":[2,2,10,10]},"nodes":{"name":["I","R1","R2","Y1","Y2"],"group":["I","R1","R2","Y1","Y2"]},"options":{"NodeID":"Node","NodeGroup":"Node","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>We can change the proportion of inputs to industry I using
<code><a href="../reference/new_k_ps.html">new_k_ps()</a></code>. To do so, we must first calculate the
input-output structure of the ECC using the <code><a href="../reference/calc_io_mats.html">calc_io_mats()</a></code>
function. Then, we call the <code><a href="../reference/new_k_ps.html">new_k_ps()</a></code> function with a new
k vector that indicates industry I now uses 75/25 mixture of
<code>R1</code> and <code>R2</code> instead of a 50/50 split between
<code>R1</code> and <code>R2</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simple_iomats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_io_mats.html">calc_io_mats</a></span><span class="op">(</span>R <span class="op">=</span> <span class="va">R</span>, U <span class="op">=</span> <span class="va">U</span>, U_feed <span class="op">=</span> <span class="va">U_feed</span>, V <span class="op">=</span> <span class="va">V</span>, Y <span class="op">=</span> <span class="va">Y</span>, S_units <span class="op">=</span> <span class="va">S_units</span><span class="op">)</span></span>
<span><span class="va">k_prime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>,</span>
<span>                    <span class="fl">0.25</span><span class="op">)</span>, </span>
<span>                  byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R1p"</span>, <span class="st">"R2p"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/setrowtype.html" class="external-link">setrowtype</a></span><span class="op">(</span><span class="st">"Products"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/setcoltype.html" class="external-link">setcoltype</a></span><span class="op">(</span><span class="st">"Industries"</span><span class="op">)</span></span>
<span><span class="va">change_input_proportions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_k_ps.html">new_k_ps</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">simple_iomats</span>, </span>
<span>                                       <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>R <span class="op">=</span> <span class="va">R</span>, U <span class="op">=</span> <span class="va">U</span>, V <span class="op">=</span> <span class="va">V</span>, Y <span class="op">=</span> <span class="va">Y</span>, </span>
<span>                                            S_units <span class="op">=</span> <span class="va">S_units</span>, </span>
<span>                                            k_prime <span class="op">=</span> <span class="va">k_prime</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/make_sankey.html">make_sankey</a></span><span class="op">(</span>R <span class="op">=</span> <span class="va">change_input_proportions</span><span class="op">$</span><span class="va">R_prime</span>, </span>
<span>            U <span class="op">=</span> <span class="va">change_input_proportions</span><span class="op">$</span><span class="va">U_prime</span>, </span>
<span>            V <span class="op">=</span> <span class="va">change_input_proportions</span><span class="op">$</span><span class="va">V_prime</span>, </span>
<span>            Y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"Sankey"</span><span class="op">)</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-c25af1359408527fd0fe" style="width:672px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-c25af1359408527fd0fe">{"x":{"links":{"source":[0,0,1,2],"target":[3,4,0,0],"value":[2,2,15,5]},"nodes":{"name":["I","R1","R2","Y1","Y2"],"group":["I","R1","R2","Y1","Y2"]},"options":{"NodeID":"Node","NodeGroup":"Node","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>In response to the different demands from industry <code>I</code>,
the rate of resource extraction from <code>R1</code> would need to grow,
and the rate of resource extraction from supply <code>R2</code> would
need to shrink. If there were additional upstream industries, they would
also change in response to the new ratio of inputs to industry
<code>I</code>.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p><code>Recca</code> has three functions that allow an analyst to
estimate the effect of changes to an ECC.</p>
<ul>
<li>
<code><a href="../reference/new_Y.html">new_Y()</a></code> estimates changes upstream of final
demand.</li>
<li>
<code><a href="../reference/new_R_ps.html">new_R_ps()</a></code> estimates changes downstream from resource
extraction.</li>
<li>
<code><a href="../reference/new_k_ps.html">new_k_ps()</a></code> estimates changes upstream of inputs to an
intermediate industry.</li>
</ul>
<p>The first of these functions (<code><a href="../reference/new_Y.html">new_Y()</a></code>) was demonstrated
in <a href="https://doi.org/10.1016/j.apenergy.2018.05.109" class="external-link">Heun et al.
<span class="citation">(2018)</span></a>. The second and third functions
(<code><a href="../reference/new_R_ps.html">new_R_ps()</a></code> and <code><a href="../reference/new_k_ps.html">new_k_ps()</a></code>) are shown here for
the first time.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Heun:2018" class="csl-entry">
Heun, Matthew Kuperus, Anne Owen, and Paul E. Brockway. 2018. <span>“A
Physical Supply-Use Table Framework for Energy Analysis on the Energy
Conversion Chain.”</span> <em>Applied Energy</em> 226 (September):
1134–62. <a href="https://doi.org/10.1016/j.apenergy.2018.05.109" class="external-link">https://doi.org/10.1016/j.apenergy.2018.05.109</a>.
</div>
<div id="ref-Leontief:1941" class="csl-entry">
Leontief, Wassily W. 1941. <em>The Structure of <span>A</span>merican
Economy, 1919-1929: An Empirical Application of Equilibrium
Analysis</em>. Cambridge, Massachusetts: Harvard University Press.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matthew Heun, Emmanuel Aramendia.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
