<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>new_* function interactions • Recca</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="new_* function interactions">
<meta property="og:description" content="Recca">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Recca</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.19</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Recca.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/new-function-interaction.html">new_* function interactions</a>
    </li>
    <li>
      <a href="../articles/new-functions.html">new_* functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MatthewHeun/Recca/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="new-function-interaction_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="new-function-interaction_files/d3-4.5.0/d3.min.js"></script><script src="new-function-interaction_files/sankey-1/sankey.js"></script><script src="new-function-interaction_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>new_* function interactions</h1>
                        <h4 class="author">Matthew Kuperus Heun</h4>
            
            <h4 class="date">2020-03-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MatthewHeun/Recca/blob/master/vignettes/new-function-interaction.Rmd"><code>vignettes/new-function-interaction.Rmd</code></a></small>
      <div class="hidden name"><code>new-function-interaction.Rmd</code></div>

    </div>

    
    
<!-- Establish some helpful LaTeX shortcuts for equations -->



<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The <code>Recca</code> package provides several <code>new_*</code> functions that allow the user to estimate a new version of an energy conversion chain (ECC) based on localized changed to one portion of the ECC. The functions can have some interesting interactions, particularly if they are called sequentially. This vignette show how to understand and deal with those interactions. The functions <code><a href="../reference/new_k_ps.html">new_k_ps()</a></code> and <code><a href="../reference/new_Y.html">new_Y()</a></code> are used for this purpose.</p>
</div>
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<p>To investigate the interactions, we first make the simplest possible ECC that retains the features to be tested, a minimum working example (MWE). This example has two resource industries (R1 and R2), one intermediate industry (I), and two final demand sectors (Y1 and Y2). The R1 industry makes product R1p.<br>
The R2 industry makes product R2p. Industry I makes product Ip. Product Ip is consumed by final demand sectors Y1 and Y2.</p>
<p>The resources (<span class="math inline">\(\mathbf{R}\)</span>), use (<span class="math inline">\(\mathbf{U}\)</span>), make (<span class="math inline">\(\mathbf{V}\)</span>), final demand (<span class="math inline">\(\mathbf{Y}\)</span>), and unit summation (<span class="math inline">\(\mathbf{S}_{units}\)</span>) matrices are given below.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">matsbyname</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Recca</span>)
<span class="no">U</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">10</span>,
              <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">10</span>,
              <span class="fl">0</span>, <span class="fl">0</span>,  <span class="fl">0</span>),
            <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">3</span>,
            <span class="kw">dimnames</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"R1p"</span>, <span class="st">"R2p"</span>, <span class="st">"Ip"</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"R1"</span>, <span class="st">"R2"</span>, <span class="st">"I"</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/setrowtype.html">setrowtype</a></span>(<span class="st">"Products"</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/setcoltype.html">setcoltype</a></span>(<span class="st">"Industries"</span>)

<span class="no">R_plus_V</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>,  <span class="fl">0</span>, <span class="fl">0</span>,
                     <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0</span>,
                     <span class="fl">0</span>,  <span class="fl">0</span>, <span class="fl">4</span>),
                   <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">3</span>,
                   <span class="kw">dimnames</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"R1"</span>, <span class="st">"R2"</span>, <span class="st">"I"</span>),
                                   <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"R1p"</span>, <span class="st">"R2p"</span>, <span class="st">"Ip"</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/setrowtype.html">setrowtype</a></span>(<span class="st">"Industries"</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/setcoltype.html">setcoltype</a></span>(<span class="st">"Products"</span>)

<span class="no">RV_mats</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/separate_RV.html">separate_RV</a></span>(<span class="kw">U</span> <span class="kw">=</span> <span class="no">U</span>, <span class="kw">R_plus_V</span> <span class="kw">=</span> <span class="no">R_plus_V</span>)
<span class="no">R</span> <span class="kw">&lt;-</span> <span class="no">RV_mats</span>$<span class="no">R</span>
<span class="no">V</span> <span class="kw">&lt;-</span> <span class="no">RV_mats</span>$<span class="no">V</span>

<span class="no">Y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>,
              <span class="fl">0</span>, <span class="fl">0</span>,
              <span class="fl">2</span>, <span class="fl">2</span>),
            <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>,
            <span class="kw">dimnames</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"R1p"</span>, <span class="st">"R2p"</span>, <span class="st">"Ip"</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Y1"</span>, <span class="st">"Y2"</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/setrowtype.html">setrowtype</a></span>(<span class="st">"Products"</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/setcoltype.html">setcoltype</a></span>(<span class="st">"Industries"</span>)

<span class="no">S_units</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,
                    <span class="fl">1</span>,
                    <span class="fl">1</span>),
                  <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">1</span>,
                  <span class="kw">dimnames</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"R1p"</span>, <span class="st">"R2p"</span>, <span class="st">"Ip"</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"quad"</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/setrowtype.html">setrowtype</a></span>(<span class="st">"Products"</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/setcoltype.html">setcoltype</a></span>(<span class="st">"Units"</span>)</pre></body></html></div>
<p>We’ll use Sankey diagrams to visualize several ECCs. The <code><a href="../reference/make_sankey.html">make_sankey()</a></code> function creates the diagrams. A Sankey diagram that shows the base energy conversion chain is shown below. <code><a href="../reference/make_sankey.html">make_sankey()</a></code> returns a list with a named item “Sankey” that we must extract to insert the diagram into this vignette.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="../reference/make_sankey.html">make_sankey</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="no">R</span>, <span class="kw">U</span> <span class="kw">=</span> <span class="no">U</span>, <span class="kw">V</span> <span class="kw">=</span> <span class="no">V</span>, <span class="kw">Y</span> <span class="kw">=</span> <span class="no">Y</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/magrittr/man/aliases.html">extract2</a></span>(<span class="st">"Sankey"</span>)</pre></body></html></div>
<div id="htmlwidget-831a2fdfb01012eff526" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-831a2fdfb01012eff526">{"x":{"links":{"source":[0,0,1,2],"target":[3,4,0,0],"value":[2,2,10,10]},"nodes":{"name":["I","R1","R2","Y1","Y2"],"group":["I","R1","R2","Y1","Y2"]},"options":{"NodeID":"Node","NodeGroup":"Node","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":20,"fontFamily":null,"nodeWidth":15,"nodePadding":14,"units":"Quads","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":500,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="adjust-inputs-to-industry-i" class="section level2">
<h2 class="hasAnchor">
<a href="#adjust-inputs-to-industry-i" class="anchor"></a>Adjust inputs to industry I</h2>
<p>We can change the proportion of inputs to industry I using <code><a href="../reference/new_k_ps.html">new_k_ps()</a></code>. To do so, we must first calculate the input-output structure of the ECC using the <code><a href="../reference/calc_io_mats.html">calc_io_mats()</a></code> function. Then, we call the <code><a href="../reference/new_k_ps.html">new_k_ps()</a></code> function with a new k vector that indicates industry I now uses 20 quads of <code>R1</code> instead of a 50/50 split between <code>R1</code> and <code>R2</code>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Recca</span>)
<span class="no">iomats</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/calc_io_mats.html">calc_io_mats</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="no">R</span>, <span class="kw">U</span> <span class="kw">=</span> <span class="no">U</span>, <span class="kw">V</span> <span class="kw">=</span> <span class="no">V</span>, <span class="kw">Y</span> <span class="kw">=</span> <span class="no">Y</span>, <span class="kw">S_units</span> <span class="kw">=</span> <span class="no">S_units</span>)
<span class="no">k_prime</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,
                    <span class="fl">0</span>),
                  <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">1</span>,
                  <span class="kw">dimnames</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"R1p"</span>, <span class="st">"R2p"</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"I"</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/setrowtype.html">setrowtype</a></span>(<span class="st">"Products"</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/setcoltype.html">setcoltype</a></span>(<span class="st">"Industries"</span>)
<span class="no">change_input_proportions</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/new_k_ps.html">new_k_ps</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">iomats</span>,
                                       <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="no">R</span>, <span class="kw">U</span> <span class="kw">=</span> <span class="no">U</span>, <span class="kw">V</span> <span class="kw">=</span> <span class="no">V</span>, <span class="kw">Y</span> <span class="kw">=</span> <span class="no">Y</span>,
                                            <span class="kw">S_units</span> <span class="kw">=</span> <span class="no">S_units</span>,
                                            <span class="kw">k_prime</span> <span class="kw">=</span> <span class="no">k_prime</span>)))
<span class="fu"><a href="../reference/make_sankey.html">make_sankey</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="no">change_input_proportions</span>$<span class="no">R_prime</span>,
            <span class="kw">U</span> <span class="kw">=</span> <span class="no">change_input_proportions</span>$<span class="no">U_prime</span>,
            <span class="kw">V</span> <span class="kw">=</span> <span class="no">change_input_proportions</span>$<span class="no">V_prime</span>,
            <span class="kw">Y</span> <span class="kw">=</span> <span class="no">Y</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/magrittr/man/aliases.html">extract2</a></span>(<span class="st">"Sankey"</span>)</pre></body></html></div>
<div id="htmlwidget-e8e699fa7c93124743be" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-e8e699fa7c93124743be">{"x":{"links":{"source":[0,0,1],"target":[2,3,0],"value":[2,2,20]},"nodes":{"name":["I","R1","Y1","Y2"],"group":["I","R1","Y1","Y2"]},"options":{"NodeID":"Node","NodeGroup":"Node","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":20,"fontFamily":null,"nodeWidth":15,"nodePadding":14,"units":"Quads","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":500,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="change-final-demand" class="section level2">
<h2 class="hasAnchor">
<a href="#change-final-demand" class="anchor"></a>Change final demand</h2>
<p>We can calculate the ECC that would be required to meet a new level of final demand with the <code><a href="../reference/new_Y.html">new_Y()</a></code> function. The <code><a href="../reference/new_k_ps.html">new_k_ps()</a></code> and <code><a href="../reference/new_Y.html">new_Y()</a></code> functions interact in ways that might be surprising to the user, depending on whether the input-output structure of the ECC is re-calculated between sequential function calls.</p>
<div id="without-recalculating-the-structure-of-the-ecc" class="section level3">
<h3 class="hasAnchor">
<a href="#without-recalculating-the-structure-of-the-ecc" class="anchor"></a>Without recalculating the structure of the ECC</h3>
<p>Now let’s change final demand, saying that consumption by Y1 doubles. But we’ll call <code><a href="../reference/new_Y.html">new_Y()</a></code> <em>without</em> recalculating the structure of the ECC with the <code><a href="../reference/calc_io_mats.html">calc_io_mats()</a></code> function.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">Y_prime</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>,
                    <span class="fl">0</span>, <span class="fl">0</span>,
                    <span class="fl">4</span>, <span class="fl">2</span>),
                  <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>,
                  <span class="kw">dimnames</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"R1p"</span>, <span class="st">"R2p"</span>, <span class="st">"Ip"</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Y1"</span>, <span class="st">"Y2"</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/setrowtype.html">setrowtype</a></span>(<span class="st">"Products"</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/matsbyname/man/setcoltype.html">setcoltype</a></span>(<span class="st">"Industries"</span>)
<span class="no">change_final_demand</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/new_Y.html">new_Y</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">iomats</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">Y_prime</span> <span class="kw">=</span> <span class="no">Y_prime</span>)))
<span class="fu"><a href="../reference/make_sankey.html">make_sankey</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="no">change_final_demand</span>$<span class="no">R_prime</span>,
            <span class="kw">U</span> <span class="kw">=</span> <span class="no">change_final_demand</span>$<span class="no">U_prime</span>,
            <span class="kw">V</span> <span class="kw">=</span> <span class="no">change_final_demand</span>$<span class="no">V_prime</span>,
            <span class="kw">Y</span> <span class="kw">=</span> <span class="no">change_final_demand</span>$<span class="no">Y_prime</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/magrittr/man/aliases.html">extract2</a></span>(<span class="st">"Sankey"</span>)</pre></body></html></div>
<div id="htmlwidget-61455c736ccb7d071049" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-61455c736ccb7d071049">{"x":{"links":{"source":[0,0,1,2],"target":[3,4,0,0],"value":[4,2,15,15]},"nodes":{"name":["I","R1","R2","Y1","Y2"],"group":["I","R1","R2","Y1","Y2"]},"options":{"NodeID":"Node","NodeGroup":"Node","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":20,"fontFamily":null,"nodeWidth":15,"nodePadding":14,"units":"Quads","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":500,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>Industry I is back to using both R1p and R2p in a 50/50 split to make its output. Both R1p and R2p now supply 15 quads to I to account for increased final demand.</p>
<p>The <code><a href="../reference/new_Y.html">new_Y()</a></code> function is performing exactly as expected, given that <code>iomats</code> was supplied to <code><a href="../reference/new_Y.html">new_Y()</a></code>. <code>iomats</code> contains information about an ECC in which industry I’s inputs are split 50/50 between R1p and R2p. So when <code><a href="../reference/new_Y.html">new_Y()</a></code> calculates a new ECC, it assumes that industry I’s needs are a 50/50 split between R1p and R2p.</p>
<p>In fact, it would be a mistake to think that <code><a href="../reference/new_Y.html">new_Y()</a></code> would give anything but a 50/50 split between R1p and R2p when using the <code>iomats</code> description of the ECC.</p>
</div>
<div id="after-recalculating-the-structure-of-the-ecc" class="section level3">
<h3 class="hasAnchor">
<a href="#after-recalculating-the-structure-of-the-ecc" class="anchor"></a>After recalculating the structure of the ECC</h3>
<p>If you want <code><a href="../reference/new_Y.html">new_Y()</a></code> to start from the Sankey in which all energy supplied to industry I comes from R1p, you need to first recalculate the input-output structure of the ECC based on the ECC in which industry I uses only R1p. I.e., you need to re-calculate an <code>iomats</code> object after calling <code><a href="../reference/new_k_ps.html">new_k_ps()</a></code> and before calling <code><a href="../reference/new_Y.html">new_Y()</a></code>. Then, you must submit that updated description of the input-output structure of the ECC to <code><a href="../reference/new_Y.html">new_Y()</a></code>. The following code demonstrates the approach.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">iomats2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/calc_io_mats.html">calc_io_mats</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="no">change_input_proportions</span>$<span class="no">R_prime</span>,
                        <span class="kw">U</span> <span class="kw">=</span> <span class="no">change_input_proportions</span>$<span class="no">U_prime</span>,
                        <span class="kw">V</span> <span class="kw">=</span> <span class="no">change_input_proportions</span>$<span class="no">V_prime</span>,
                        <span class="kw">Y</span> <span class="kw">=</span> <span class="no">Y</span>, <span class="kw">S_units</span> <span class="kw">=</span> <span class="no">S_units</span>)
<span class="no">change_final_demand2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/new_Y.html">new_Y</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">iomats2</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">Y_prime</span> <span class="kw">=</span> <span class="no">Y_prime</span>)))
<span class="fu"><a href="../reference/make_sankey.html">make_sankey</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="no">change_final_demand2</span>$<span class="no">R_prime</span>,
            <span class="kw">U</span> <span class="kw">=</span> <span class="no">change_final_demand2</span>$<span class="no">U_prime</span>,
            <span class="kw">V</span> <span class="kw">=</span> <span class="no">change_final_demand2</span>$<span class="no">V_prime</span>,
            <span class="kw">Y</span> <span class="kw">=</span> <span class="no">change_final_demand2</span>$<span class="no">Y_prime</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/magrittr/man/aliases.html">extract2</a></span>(<span class="st">"Sankey"</span>)</pre></body></html></div>
<div id="htmlwidget-48e1a0e7d6b24539983c" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-48e1a0e7d6b24539983c">{"x":{"links":{"source":[0,0,1],"target":[2,3,0],"value":[4,2,30]},"nodes":{"name":["I","R1","Y1","Y2"],"group":["I","R1","Y1","Y2"]},"options":{"NodeID":"Node","NodeGroup":"Node","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":20,"fontFamily":null,"nodeWidth":15,"nodePadding":14,"units":"Quads","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":500,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>The Sankey diagram above shows that we have successfully increased the demand from <code>Y1</code> while ensuring that all inputs to industry I come from R1p. The “trick” is to recalculate the input-output structure of the ECC between the two steps.</p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h1>
<p>The <code>new_*</code> function of the <code>Recca</code> package can be called sequentially. But the interactions among the <code>new_*</code> functions can be surprising if their behavior is not fully understood. This vignette provides a detailed example using the <code><a href="../reference/new_k_ps.html">new_k_ps()</a></code> and <code><a href="../reference/new_Y.html">new_Y()</a></code> functions. If they are called sequentially <em>without</em> first recalculating the input-output structure of the ECC, the call to <code><a href="../reference/new_Y.html">new_Y()</a></code> will be based on the original input-output structure of the ECC (from before <code><a href="../reference/new_k_ps.html">new_k_ps()</a></code> was called). If <code><a href="../reference/calc_io_mats.html">calc_io_mats()</a></code> is called between the sequential calls to <code><a href="../reference/new_k_ps.html">new_k_ps()</a></code> and <code><a href="../reference/new_Y.html">new_Y()</a></code> and the results are fed to <code><a href="../reference/new_Y.html">new_Y()</a></code>, the input-output structure of the ECC <em>after</em> calling <code><a href="../reference/new_k_ps.html">new_k_ps()</a></code> will be used for the calculations by <code><a href="../reference/new_Y.html">new_Y()</a></code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matthew Heun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
