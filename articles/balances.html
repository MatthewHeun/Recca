<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Balances â€¢ Recca</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Balances">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Recca</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.67</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/Recca.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Aggregation.html">Aggregation</a></li>
    <li><a class="dropdown-item" href="../articles/balances.html">Balances</a></li>
    <li><a class="dropdown-item" href="../articles/new-function-interaction.html">new_* function interactions</a></li>
    <li><a class="dropdown-item" href="../articles/new-functions.html">new_* functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MatthewHeun/Recca/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Balances</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MatthewHeun/Recca/blob/v0.1.67/vignettes/balances.Rmd" class="external-link"><code>vignettes/balances.Rmd</code></a></small>
      <div class="d-none name"><code>balances.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://matthewheun.github.io/IEATools/" class="external-link">IEATools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MatthewHeun/Recca" class="external-link">Recca</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>When working with material and energy conversion chains in the
<code>Recca</code> package with <code>matsindf</code> data frames, it is
helpful to calculate several types of balances. This vignette describes
those balances and shows when you might want to use each of them.
Balances include</p>
<ul>
<li>inter-industry balances,</li>
<li>intra-industry balances, and</li>
<li>the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ–</mi><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math>
matrix.</li>
</ul>
<div class="section level3">
<h3 id="terminology">Terminology<a class="anchor" aria-label="anchor" href="#terminology"></a>
</h3>
<p><code>Recca</code> assists with matrix-based input-output
calculations when the data are organized into the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ‘</mi><mi>ğ”</mi><mi>ğ•</mi><mi>ğ˜</mi></mrow><annotation encoding="application/x-tex">\mathbf{RUVY}</annotation></semantics></math>
matrices of the physical supply-use table (PSUT) framework. A generic
processing stage is called an â€œindustry.â€ The stuff that flows between
industries is generically called a â€œproduct.â€ A â€œbalanceâ€ is any
calculation that compares inputs to outputs. Balances can be computed
for all types of products, in particular materials (quantified in mass
or exergy units) and energy (quantified as energy or exergy).</p>
<p>In the PSUT framework, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ‘</mi><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math>
matrix is an industry-by-product resource matrix. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ”</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math>
matrix is an product-by-industry use matrix. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ•</mi><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math>
matrix is an industry-by-product make matrix. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ˜</mi><annotation encoding="application/x-tex">\mathbf{Y}</annotation></semantics></math>
matrix is an product-by-industry final demand matrix.</p>
<p>In this vignette, matrices are represented by boldface capital
letters, such as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ‘</mi><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math>.
Vectors are assumed to be column vectors and represented by boldface
lowercase letters, such as the identity vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ¢</mi><annotation encoding="application/x-tex">\mathbf{i}</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>In the examples that follow, we use the energy conversion chain in
<code>UKEnergy2000mats</code> from the <code>Recca</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ecc</span> <span class="op">&lt;-</span> <span class="va">UKEnergy2000mats</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">matrix.name</span>, </span>
<span>                     values_from <span class="op">=</span> <span class="va">matrix</span><span class="op">)</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">ecc</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 4</span></span>
<span><span class="co">#&gt; Columns: 12</span></span>
<span><span class="co">#&gt; $ Country    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GBR"<span style="color: #949494;">, </span>"GBR"<span style="color: #949494;">, </span>"GBR"<span style="color: #949494;">, </span>"GBR"</span></span>
<span><span class="co">#&gt; $ Year       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2000<span style="color: #949494;">, </span>2000<span style="color: #949494;">, </span>2000<span style="color: #949494;">, </span>2000</span></span>
<span><span class="co">#&gt; $ EnergyType <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E"<span style="color: #949494;">, </span>"E"<span style="color: #949494;">, </span>"E"<span style="color: #949494;">, </span>"X"</span></span>
<span><span class="co">#&gt; $ LastStage  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final"<span style="color: #949494;">, </span>"Services"<span style="color: #949494;">, </span>"Useful"<span style="color: #949494;">, </span>"Services"</span></span>
<span><span class="co">#&gt; $ R          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[2 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[2 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;â€¦</span></span>
<span><span class="co">#&gt; $ U          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[17 x 17]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 13]&gt;â€¦</span></span>
<span><span class="co">#&gt; $ U_EIOU     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 8]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[3 x 8]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[3 x 8]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;â€¦</span></span>
<span><span class="co">#&gt; $ U_feed     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[16 x 17]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[12 x 13]&gt;&gt;â€¦</span></span>
<span><span class="co">#&gt; $ V          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 10]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[17 x 18]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 14]â€¦</span></span>
<span><span class="co">#&gt; $ Y          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[4 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[4 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[4 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;â€¦</span></span>
<span><span class="co">#&gt; $ r_EIOU     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[17 x 17]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 13]â€¦</span></span>
<span><span class="co">#&gt; $ S_units    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[20 x 5]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[16 x 1]&gt;&gt;â€¦</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="balances">Balances<a class="anchor" aria-label="anchor" href="#balances"></a>
</h2>
<p>The following subsections explain each type of balance and how to
calculate it with the <code>Recca</code> package.</p>
<div class="section level3">
<h3 id="inter-industry-between-industry-balances-check-for-product-consistency">Inter-industry (between-industry) balances check for product
consistency<a class="anchor" aria-label="anchor" href="#inter-industry-between-industry-balances-check-for-product-consistency"></a>
</h3>
<p>In any conversion chain, products that leave one industry must enter
another industry. Inter-industry balances are a product balance that
ensures that the total supply of any product is equal to the total use
of any product within the conversion chain. These inter-industry (or
between-industry) balances should be verified for every conversion chain
to ensure consistency.</p>
<p>Inter-industry balances are obtained by the following
computation.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‘</mi><mo>+</mo><mi>ğ•</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi mathvariant="normal">T</mi></msup><mo>âˆ’</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ”</mi><mo>+</mo><mi>ğ˜</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mspace width="0.167em"></mspace><mi>ğ¢</mi></mrow><annotation encoding="application/x-tex">[(\mathbf{R} + \mathbf{V})^\mathrm{T} 
     - (\mathbf{U} + \mathbf{Y})] \, \mathbf{i}</annotation></semantics></math></p>
<p>If the conversion chain is consistent, the result should be the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>ğŸ</mn><annotation encoding="application/x-tex">\mathbf{0}</annotation></semantics></math>
vector with products in rows.</p>
<p>To compute inter-industry balances within the PSUT framework using
the <code>Recca</code> package, use the following code.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inter_industry_balances</span> <span class="op">&lt;-</span> <span class="va">ecc</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/balances.html">calc_inter_industry_balance</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The result is added as a new column, named â€œSUTInterIndustryBalanceâ€
by default.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">inter_industry_balances</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 4</span></span>
<span><span class="co">#&gt; Columns: 13</span></span>
<span><span class="co">#&gt; $ Country                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GBR"<span style="color: #949494;">, </span>"GBR"<span style="color: #949494;">, </span>"GBR"<span style="color: #949494;">, </span>"GBR"</span></span>
<span><span class="co">#&gt; $ Year                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2000<span style="color: #949494;">, </span>2000<span style="color: #949494;">, </span>2000<span style="color: #949494;">, </span>2000</span></span>
<span><span class="co">#&gt; $ EnergyType              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E"<span style="color: #949494;">, </span>"E"<span style="color: #949494;">, </span>"E"<span style="color: #949494;">, </span>"X"</span></span>
<span><span class="co">#&gt; $ LastStage               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final"<span style="color: #949494;">, </span>"Services"<span style="color: #949494;">, </span>"Useful"<span style="color: #949494;">, </span>"Services"</span></span>
<span><span class="co">#&gt; $ R                       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[2 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrixâ€¦</span></span>
<span><span class="co">#&gt; $ U                       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[17 x 17]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matâ€¦</span></span>
<span><span class="co">#&gt; $ U_EIOU                  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 8]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[3 x 8]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrixâ€¦</span></span>
<span><span class="co">#&gt; $ U_feed                  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[16 x 17]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrâ€¦</span></span>
<span><span class="co">#&gt; $ V                       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 10]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[17 x 18]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;maâ€¦</span></span>
<span><span class="co">#&gt; $ Y                       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[4 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[4 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matriâ€¦</span></span>
<span><span class="co">#&gt; $ r_EIOU                  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[17 x 17]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;maâ€¦</span></span>
<span><span class="co">#&gt; $ S_units                 <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[20 x 5]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matâ€¦</span></span>
<span><span class="co">#&gt; $ SUTInterIndustryBalance <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[20 x 1]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matâ€¦</span></span></code></pre></div>
<p>The vectors in SUTInterIndustryBalance column have products in
rows.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inter_industry_balances</span><span class="op">$</span><span class="va">SUTInterIndustryBalance</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                     Industry</span></span>
<span><span class="co">#&gt; Crude                      0</span></span>
<span><span class="co">#&gt; Crude [from Dist.]         0</span></span>
<span><span class="co">#&gt; Crude [from Fields]        0</span></span>
<span><span class="co">#&gt; Diesel                     0</span></span>
<span><span class="co">#&gt; Diesel [from Dist.]        0</span></span>
<span><span class="co">#&gt; Elect                      0</span></span>
<span><span class="co">#&gt; Elect [from Grid]          0</span></span>
<span><span class="co">#&gt; NG                         0</span></span>
<span><span class="co">#&gt; NG [from Dist.]            0</span></span>
<span><span class="co">#&gt; NG [from Wells]            0</span></span>
<span><span class="co">#&gt; Petrol                     0</span></span>
<span><span class="co">#&gt; Petrol [from Dist.]        0</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="va">inter_industry_balances</span><span class="op">$</span><span class="va">SUTInterIndustryBalance</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                                  Industry</span></span>
<span><span class="co">#&gt; Crude                        0.000000e+00</span></span>
<span><span class="co">#&gt; Crude [from Dist.]           0.000000e+00</span></span>
<span><span class="co">#&gt; Crude [from Fields]          0.000000e+00</span></span>
<span><span class="co">#&gt; Diesel                       0.000000e+00</span></span>
<span><span class="co">#&gt; Diesel [from Dist.]          0.000000e+00</span></span>
<span><span class="co">#&gt; Elect                        0.000000e+00</span></span>
<span><span class="co">#&gt; Elect [from Grid]            0.000000e+00</span></span>
<span><span class="co">#&gt; Freight [tonne-km/year]      3.051758e-05</span></span>
<span><span class="co">#&gt; Illumination [lumen-hrs/yr]  0.000000e+00</span></span>
<span><span class="co">#&gt; Light                        0.000000e+00</span></span>
<span><span class="co">#&gt; LTH                          0.000000e+00</span></span>
<span><span class="co">#&gt; MD [from Car engines]       -1.364242e-12</span></span>
<span><span class="co">#&gt; MD [from Truck engines]      4.547474e-13</span></span>
<span><span class="co">#&gt; NG                           0.000000e+00</span></span>
<span><span class="co">#&gt; NG [from Dist.]              0.000000e+00</span></span>
<span><span class="co">#&gt; NG [from Wells]              0.000000e+00</span></span>
<span><span class="co">#&gt; Passenger [passenger-km/yr]  0.000000e+00</span></span>
<span><span class="co">#&gt; Petrol                       0.000000e+00</span></span>
<span><span class="co">#&gt; Petrol [from Dist.]          0.000000e+00</span></span>
<span><span class="co">#&gt; Space heating [m3-K]         0.000000e+00</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="va">inter_industry_balances</span><span class="op">$</span><span class="va">SUTInterIndustryBalance</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                             Industry</span></span>
<span><span class="co">#&gt; Crude                   0.000000e+00</span></span>
<span><span class="co">#&gt; Crude [from Dist.]      0.000000e+00</span></span>
<span><span class="co">#&gt; Crude [from Fields]     0.000000e+00</span></span>
<span><span class="co">#&gt; Diesel                  0.000000e+00</span></span>
<span><span class="co">#&gt; Diesel [from Dist.]     0.000000e+00</span></span>
<span><span class="co">#&gt; Elect                   0.000000e+00</span></span>
<span><span class="co">#&gt; Elect [from Grid]       0.000000e+00</span></span>
<span><span class="co">#&gt; Light                   0.000000e+00</span></span>
<span><span class="co">#&gt; LTH                     0.000000e+00</span></span>
<span><span class="co">#&gt; MD [from Car engines]   0.000000e+00</span></span>
<span><span class="co">#&gt; MD [from Truck engines] 2.273737e-13</span></span>
<span><span class="co">#&gt; NG                      0.000000e+00</span></span>
<span><span class="co">#&gt; NG [from Dist.]         0.000000e+00</span></span>
<span><span class="co">#&gt; NG [from Wells]         0.000000e+00</span></span>
<span><span class="co">#&gt; Petrol                  0.000000e+00</span></span>
<span><span class="co">#&gt; Petrol [from Dist.]     0.000000e+00</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="va">inter_industry_balances</span><span class="op">$</span><span class="va">SUTInterIndustryBalance</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                                 Industry</span></span>
<span><span class="co">#&gt; Crude                       0.000000e+00</span></span>
<span><span class="co">#&gt; Crude [from Dist.]          0.000000e+00</span></span>
<span><span class="co">#&gt; Crude [from Fields]         0.000000e+00</span></span>
<span><span class="co">#&gt; Diesel                      0.000000e+00</span></span>
<span><span class="co">#&gt; Diesel [from Dist.]         0.000000e+00</span></span>
<span><span class="co">#&gt; Elect                       0.000000e+00</span></span>
<span><span class="co">#&gt; Elect [from Grid]           0.000000e+00</span></span>
<span><span class="co">#&gt; Freight [tonne-km/year]     3.051758e-05</span></span>
<span><span class="co">#&gt; Illumination [lumen-hrs/yr] 0.000000e+00</span></span>
<span><span class="co">#&gt; Light                       0.000000e+00</span></span>
<span><span class="co">#&gt; LTH                         0.000000e+00</span></span>
<span><span class="co">#&gt; MD [from Car engines]       0.000000e+00</span></span>
<span><span class="co">#&gt; MD [from Truck engines]     0.000000e+00</span></span>
<span><span class="co">#&gt; NG                          0.000000e+00</span></span>
<span><span class="co">#&gt; NG [from Dist.]             0.000000e+00</span></span>
<span><span class="co">#&gt; NG [from Wells]             0.000000e+00</span></span>
<span><span class="co">#&gt; Passenger [passenger-km/yr] 0.000000e+00</span></span>
<span><span class="co">#&gt; Petrol                      0.000000e+00</span></span>
<span><span class="co">#&gt; Petrol [from Dist.]         0.000000e+00</span></span>
<span><span class="co">#&gt; Space heating [m3-K]        0.000000e+00</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span></code></pre></div>
<p>As expected, these vectors are the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>ğŸ</mn><annotation encoding="application/x-tex">\mathbf{0}</annotation></semantics></math>
vector to within reasonable precision.</p>
<p>To check the inter-industry balances for consistency, use
<code><a href="../reference/verify-balances.html">verify_inter_industry_balance()</a></code>. The <code>tol</code>
argument gives the tolerance for non-zero product balances.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inter_industry_balances</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/verify-balances.html">verify_inter_industry_balance</a></span><span class="op">(</span>tol <span class="op">=</span> <span class="fl">1e-4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 4</span></span>
<span><span class="co">#&gt; Columns: 14</span></span>
<span><span class="co">#&gt; $ Country                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GBR"<span style="color: #949494;">, </span>"GBR"<span style="color: #949494;">, </span>"GBR"<span style="color: #949494;">, </span>"GBR"</span></span>
<span><span class="co">#&gt; $ Year                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2000<span style="color: #949494;">, </span>2000<span style="color: #949494;">, </span>2000<span style="color: #949494;">, </span>2000</span></span>
<span><span class="co">#&gt; $ EnergyType               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E"<span style="color: #949494;">, </span>"E"<span style="color: #949494;">, </span>"E"<span style="color: #949494;">, </span>"X"</span></span>
<span><span class="co">#&gt; $ LastStage                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final"<span style="color: #949494;">, </span>"Services"<span style="color: #949494;">, </span>"Useful"<span style="color: #949494;">, </span>"Services"</span></span>
<span><span class="co">#&gt; $ R                        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[2 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matriâ€¦</span></span>
<span><span class="co">#&gt; $ U                        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[17 x 17]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;maâ€¦</span></span>
<span><span class="co">#&gt; $ U_EIOU                   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 8]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[3 x 8]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matriâ€¦</span></span>
<span><span class="co">#&gt; $ U_feed                   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[16 x 17]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matâ€¦</span></span>
<span><span class="co">#&gt; $ V                        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 10]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[17 x 18]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;mâ€¦</span></span>
<span><span class="co">#&gt; $ Y                        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[4 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[4 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrâ€¦</span></span>
<span><span class="co">#&gt; $ r_EIOU                   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[17 x 17]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;mâ€¦</span></span>
<span><span class="co">#&gt; $ S_units                  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[20 x 5]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;maâ€¦</span></span>
<span><span class="co">#&gt; $ SUTInterIndustryBalance  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[20 x 1]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;maâ€¦</span></span>
<span><span class="co">#&gt; $ SUTInterIndustryBalanced <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> TRUE<span style="color: #949494;">, </span>TRUE<span style="color: #949494;">, </span>TRUE<span style="color: #949494;">, </span>TRUE</span></span></code></pre></div>
<p>To calculate and verify the balances without adding any columns to
the data frame, set <code>delete_balance_if_verified = TRUE</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inter_industry_balances</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/verify-balances.html">verify_inter_industry_balance</a></span><span class="op">(</span>tol <span class="op">=</span> <span class="fl">1e-4</span>, </span>
<span>                                delete_balance_if_verified <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 4</span></span>
<span><span class="co">#&gt; Columns: 12</span></span>
<span><span class="co">#&gt; $ Country    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GBR"<span style="color: #949494;">, </span>"GBR"<span style="color: #949494;">, </span>"GBR"<span style="color: #949494;">, </span>"GBR"</span></span>
<span><span class="co">#&gt; $ Year       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2000<span style="color: #949494;">, </span>2000<span style="color: #949494;">, </span>2000<span style="color: #949494;">, </span>2000</span></span>
<span><span class="co">#&gt; $ EnergyType <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E"<span style="color: #949494;">, </span>"E"<span style="color: #949494;">, </span>"E"<span style="color: #949494;">, </span>"X"</span></span>
<span><span class="co">#&gt; $ LastStage  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final"<span style="color: #949494;">, </span>"Services"<span style="color: #949494;">, </span>"Useful"<span style="color: #949494;">, </span>"Services"</span></span>
<span><span class="co">#&gt; $ R          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[2 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[2 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;â€¦</span></span>
<span><span class="co">#&gt; $ U          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[17 x 17]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 13]&gt;â€¦</span></span>
<span><span class="co">#&gt; $ U_EIOU     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 8]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[3 x 8]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[3 x 8]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;â€¦</span></span>
<span><span class="co">#&gt; $ U_feed     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[16 x 17]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[12 x 13]&gt;&gt;â€¦</span></span>
<span><span class="co">#&gt; $ V          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 10]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[17 x 18]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 14]â€¦</span></span>
<span><span class="co">#&gt; $ Y          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[4 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[4 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[4 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;â€¦</span></span>
<span><span class="co">#&gt; $ r_EIOU     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[17 x 17]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 13]â€¦</span></span>
<span><span class="co">#&gt; $ S_units    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[20 x 5]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[16 x 1]&gt;&gt;â€¦</span></span></code></pre></div>
<p>If a product is out of balance by more than <code>tol</code> (by
default <code>1e-6</code>), a warning occurs and <code>FALSE</code>
appears in the new column, â€œSUTInterIndustryBalanced.â€</p>
</div>
<div class="section level3">
<h3 id="intra-industry-across-industry-balances">Intra-industry (across-industry) balances<a class="anchor" aria-label="anchor" href="#intra-industry-across-industry-balances"></a>
</h3>
<p>A second type of balance (the intra-industry balance) computes
differences <em>across</em> industries, inputs
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ”</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math>)
less outputs
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ•</mi><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math>).
Intra-industry balances are obtained by the following computation.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ğ”</mi><mi mathvariant="normal">T</mi></msup><mo>âˆ’</mo><mi>ğ•</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>ğ¢</mi></mrow><annotation encoding="application/x-tex">(\mathbf{U}^\mathrm{T} - \mathbf{V}) \, \mathbf{i}</annotation></semantics></math></p>
<p>The result is a column vector with industries in rows. In the
resultant column vector, losses are positive values.</p>
<p>The interpretation of the results depends upon the construction of
the matrices. In a PSUT description of conserved quantities (such as
mass or energy), when all losses are accounted within the matrices
themselves, the calculation of intra-industry balances should give the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>ğŸ</mn><annotation encoding="application/x-tex">\mathbf{0}</annotation></semantics></math>
vector. When losses <em>are not</em> accounted in the matrices, the
calculation of intra-industry balances gives losses.</p>
<p>For PSUT matrices describing non-conserved quantities such as exergy
(mass exergy, energy exergy, or both), when losses <em>are</em>
accounted in the matrices, the intra-industry balance gives destruction
of the non-conserved quantity. When losses <em>are not</em> accounted in
the matrices, the intra-industry balance gives the sum of destruction
and losses.</p>
<p>The following table summarizes the above points, giving the result of
intra-industry balances for various conversion chain types, depending on
whether the matrices include losses.</p>
<table class="table">
<colgroup>
<col width="30%">
<col width="35%">
<col width="34%">
</colgroup>
<thead><tr class="header">
<th align="center">Matrices contain</th>
<th align="center">Matrices include losses (wastes)</th>
<th align="center">Matrices exclude losses (wastes)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Mass (MCC)</td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>ğŸ</mn><annotation encoding="application/x-tex">\mathbf{0}</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ¦</mi><mi>L</mi></msub><annotation encoding="application/x-tex">\mathbf{m}_L</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="center">Energy (ECC)</td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>ğŸ</mn><annotation encoding="application/x-tex">\mathbf{0}</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ</mi><mi>L</mi></msub><annotation encoding="application/x-tex">\mathbf{e}_L</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td align="center">Mass exergy (BCC)</td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›</mi><mi>D</mi></msub><annotation encoding="application/x-tex">\mathbf{b}_D</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ›</mi><mi>D</mi></msub><mo>+</mo><msub><mi>ğ›</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{b}_D + \mathbf{b}_L</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="center">Energy exergy (XCC)</td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ±</mi><mi>D</mi></msub><annotation encoding="application/x-tex">\mathbf{x}_D</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ±</mi><mi>D</mi></msub><mo>+</mo><msub><mi>ğ±</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{x}_D + \mathbf{x}_L</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td align="center">Mass and energy exergy (BXCC)</td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ›</mi><mi>D</mi></msub><mo>+</mo><msub><mi>ğ±</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{b}_D + \mathbf{x}_D</annotation></semantics></math></td>
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ›</mi><mi>D</mi></msub><mo>+</mo><msub><mi>ğ›</mi><mi>L</mi></msub><mo>+</mo><msub><mi>ğ±</mi><mi>D</mi></msub><mo>+</mo><msub><mi>ğ±</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{b}_D + \mathbf{b}_L + \mathbf{x}_D + \mathbf{x}_L</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>MCC indicates a material conversion chain. ECC indicates an energy
conversion chain. BCC indicates a material exergy conversion chain. XCC
indicates an energy exergy conversion chain. BXCC indicates a combined
material and energy exergy conversion chain.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>ğŸ</mn><annotation encoding="application/x-tex">\mathbf{0}</annotation></semantics></math>
indicates the result is the zero vector;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ¦</mi><annotation encoding="application/x-tex">\mathbf{m}</annotation></semantics></math>
indicates the result is a mass vector;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ</mi><annotation encoding="application/x-tex">\mathbf{e}</annotation></semantics></math>
indicates the result is an energy vector;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›</mi><annotation encoding="application/x-tex">\mathbf{b}</annotation></semantics></math>
indicates the result is a mass exergy vector; and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math>
indicates the result is an energy exergy vector. Subscript
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
indicates losses (or wastes), and subscript
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
indicates exergy destroyed by the industry.</p>
<p>To compute intra-industry (across-industry) balances within the PSUT
framework using the <code>Recca</code> package, use the following
code.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">intra_industry_balances</span> <span class="op">&lt;-</span> <span class="va">ecc</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EnergyType</span> <span class="op">==</span> <span class="st">"E"</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">LastStage</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Final"</span>, <span class="st">"Useful"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/balances.html">calc_intra_industry_balance</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The result is added as a new column, named â€œSUTIntraIndustryBalanceâ€
by default.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">intra_industry_balances</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 2</span></span>
<span><span class="co">#&gt; Columns: 13</span></span>
<span><span class="co">#&gt; $ Country                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GBR"<span style="color: #949494;">, </span>"GBR"</span></span>
<span><span class="co">#&gt; $ Year                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2000<span style="color: #949494;">, </span>2000</span></span>
<span><span class="co">#&gt; $ EnergyType              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E"<span style="color: #949494;">, </span>"E"</span></span>
<span><span class="co">#&gt; $ LastStage               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final"<span style="color: #949494;">, </span>"Useful"</span></span>
<span><span class="co">#&gt; $ R                       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[2 x 2]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U                       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 13]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_EIOU                  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 8]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[3 x 8]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_feed                  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[12 x 13]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ V                       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 10]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 14]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Y                       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[4 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[4 x 2]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r_EIOU                  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 13]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ S_units                 <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[16 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ SUTIntraIndustryBalance <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 1]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 1]&gt;&gt;</span></span></code></pre></div>
<p>Unsurprisingly, a warning is issued, because verification is
unsuccessful.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">intra_industry_balances</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/verify-balances.html">verify_intra_industry_balance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in verify_intra_industry_balance(intra_industry_balances): Industries</span></span>
<span><span class="co">#&gt; are not balanced in verify_intra_industry_balance(). See column</span></span>
<span><span class="co">#&gt; SUTIntraIndustryBalanced.</span></span>
<span><span class="co">#&gt; Rows: 2</span></span>
<span><span class="co">#&gt; Columns: 14</span></span>
<span><span class="co">#&gt; $ Country                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GBR"<span style="color: #949494;">, </span>"GBR"</span></span>
<span><span class="co">#&gt; $ Year                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2000<span style="color: #949494;">, </span>2000</span></span>
<span><span class="co">#&gt; $ EnergyType               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E"<span style="color: #949494;">, </span>"E"</span></span>
<span><span class="co">#&gt; $ LastStage                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final"<span style="color: #949494;">, </span>"Useful"</span></span>
<span><span class="co">#&gt; $ R                        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[2 x 2]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U                        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 13]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_EIOU                   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 8]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[3 x 8]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_feed                   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[12 x 13]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ V                        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 10]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 14]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Y                        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[4 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[4 x 2]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r_EIOU                   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 13]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ S_units                  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[16 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ SUTIntraIndustryBalance  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 1]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ SUTIntraIndustryBalanced <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE<span style="color: #949494;">, </span>FALSE</span></span></code></pre></div>
<p>The vectors in the â€œSUTIntraIndustryBalanceâ€ column have industries
in rows.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">intra_industry_balances</span><span class="op">$</span><span class="va">SUTIntraIndustryBalance</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   Product</span></span>
<span><span class="co">#&gt; Crude dist.           550</span></span>
<span><span class="co">#&gt; Diesel dist.          350</span></span>
<span><span class="co">#&gt; Elect. grid           125</span></span>
<span><span class="co">#&gt; Gas wells &amp; proc.    2075</span></span>
<span><span class="co">#&gt; NG dist.               50</span></span>
<span><span class="co">#&gt; Oil fields           2575</span></span>
<span><span class="co">#&gt; Oil refineries       5075</span></span>
<span><span class="co">#&gt; Petrol dist.          750</span></span>
<span><span class="co">#&gt; Power plants         9700</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="va">intra_industry_balances</span><span class="op">$</span><span class="va">SUTIntraIndustryBalance</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                      Product</span></span>
<span><span class="co">#&gt; Car engines       22999.6000</span></span>
<span><span class="co">#&gt; Crude dist.         545.0000</span></span>
<span><span class="co">#&gt; Diesel dist.        367.9998</span></span>
<span><span class="co">#&gt; Elect. grid         125.0000</span></span>
<span><span class="co">#&gt; Furnaces           5000.0000</span></span>
<span><span class="co">#&gt; Gas wells &amp; proc.  2075.0000</span></span>
<span><span class="co">#&gt; Light fixtures     4800.0000</span></span>
<span><span class="co">#&gt; NG dist.             45.0000</span></span>
<span><span class="co">#&gt; Oil fields         2575.0000</span></span>
<span><span class="co">#&gt; Oil refineries     5075.0000</span></span>
<span><span class="co">#&gt; Petrol dist.        526.9997</span></span>
<span><span class="co">#&gt; Power plants       9700.0000</span></span>
<span><span class="co">#&gt; Truck engines     13250.0200</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span></code></pre></div>
<p>Because the matrices in <code>ecc</code> do not contain losses,
<code><a href="../reference/balances.html">calc_intra_industry_balance()</a></code> calculates energy losses
(waste heat and waste products)
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ</mi><mi>L</mi></msub><annotation encoding="application/x-tex">\mathbf{e}_L</annotation></semantics></math>
in the table above).</p>
</div>
<div class="section level3">
<h3 id="endogenizing-intra-industry-losses">Endogenizing intra-industry losses<a class="anchor" aria-label="anchor" href="#endogenizing-intra-industry-losses"></a>
</h3>
<p>The intra-industry losses can be endogenized, i.e., added to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ‘</mi><mi>ğ”</mi><mi>ğ•</mi><mi>ğ˜</mi></mrow><annotation encoding="application/x-tex">\mathbf{RUVY}</annotation></semantics></math>
matrices of the PSUT framework. with <code><a href="../reference/endogenize_losses.html">endogenize_losses()</a></code>.
But first, one needs to allocate the losses from each sector to a
particular type of product or set of products. The allocation of losses
to products is accomplished by a matrix with industries in rows and loss
products in columns. The rows of the loss allocation matrix must sum to
1. The <code>losses_alloc</code> column (by default
<code>Recca::balance_cols$losses_alloc_colname</code> or â€œLossesAllocâ€)
contains those matrices.</p>
<p>A default loss allocation matrix (that allocates losses from every
industry to â€œWaste heatâ€) is given in
<code>Recca::balance_cols$default_losses_alloc_mat</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="../reference/balance_cols.html">balance_cols</a></span><span class="op">$</span><span class="va">default_losses_alloc_mat</span></span>
<span><span class="co">#&gt;                Waste</span></span>
<span><span class="co">#&gt; All industries     1</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span></code></pre></div>
<p>To use a default losses allocation matrix, add a matrix column of
loss allocations as shown below.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iibs_with_loss_allocs</span> <span class="op">&lt;-</span> <span class="va">intra_industry_balances</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="st">"{Recca::balance_cols$losses_alloc_colname}"</span> <span class="op">:=</span></span>
<span>      <span class="fu">RCLabels</span><span class="fu">::</span><span class="fu"><a href="https://matthewheun.github.io/RCLabels/reference/make_list.html" class="external-link">make_list</a></span><span class="op">(</span><span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="../reference/balance_cols.html">balance_cols</a></span><span class="op">$</span><span class="va">default_losses_alloc</span>,</span>
<span>                          n <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                          lenx <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Now, endogenizing the losses proceeds with a call to
<code><a href="../reference/endogenize_losses.html">endogenize_losses()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endogenized</span> <span class="op">&lt;-</span> <span class="va">iibs_with_loss_allocs</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/endogenize_losses.html">endogenize_losses</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/endogenize_losses.html">endogenize_losses()</a></code> adds two new columns: by default
<code>V_prime</code> and <code>Y_prime</code>. <code>V_prime</code> and
<code>Y_prime</code> contain
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ•</mi><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ˜</mi><annotation encoding="application/x-tex">\mathbf{Y}</annotation></semantics></math>
matrices with losses included directly in the matrices. In the example,
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ğ•</mi><mi>â€²</mi></msup><annotation encoding="application/x-tex">\mathbf{V}^{\prime}</annotation></semantics></math>
matrices contain a new column (named â€œWaste heatâ€ by default) that shows
the heat losses from each industry.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endogenized</span><span class="op">$</span><span class="va">V_prime</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   Crude [from Dist.] Crude [from Fields] Diesel</span></span>
<span><span class="co">#&gt; Crude dist.                    47500                   0      0</span></span>
<span><span class="co">#&gt; Diesel dist.                       0                   0      0</span></span>
<span><span class="co">#&gt; Elect. grid                        0                   0      0</span></span>
<span><span class="co">#&gt; Gas wells &amp; proc.                  0                   0      0</span></span>
<span><span class="co">#&gt; NG dist.                           0                   0      0</span></span>
<span><span class="co">#&gt; Oil fields                         0               50000      0</span></span>
<span><span class="co">#&gt; Oil refineries                     0                   0  20500</span></span>
<span><span class="co">#&gt; Petrol dist.                       0                   0      0</span></span>
<span><span class="co">#&gt; Power plants                       0                   0      0</span></span>
<span><span class="co">#&gt;                   Diesel [from Dist.] Elect Elect [from Grid] NG [from Dist.]</span></span>
<span><span class="co">#&gt; Crude dist.                         0     0                 0               0</span></span>
<span><span class="co">#&gt; Diesel dist.                    15500     0                 0               0</span></span>
<span><span class="co">#&gt; Elect. grid                         0     0              6275               0</span></span>
<span><span class="co">#&gt; Gas wells &amp; proc.                   0     0                 0               0</span></span>
<span><span class="co">#&gt; NG dist.                            0     0                 0           41000</span></span>
<span><span class="co">#&gt; Oil fields                          0     0                 0               0</span></span>
<span><span class="co">#&gt; Oil refineries                      0     0                 0               0</span></span>
<span><span class="co">#&gt; Petrol dist.                        0     0                 0               0</span></span>
<span><span class="co">#&gt; Power plants                        0  6400                 0               0</span></span>
<span><span class="co">#&gt;                   NG [from Wells] Petrol Petrol [from Dist.] Waste</span></span>
<span><span class="co">#&gt; Crude dist.                     0      0                   0   550</span></span>
<span><span class="co">#&gt; Diesel dist.                    0      0                   0   350</span></span>
<span><span class="co">#&gt; Elect. grid                     0      0                   0   125</span></span>
<span><span class="co">#&gt; Gas wells &amp; proc.           43000      0                   0  2075</span></span>
<span><span class="co">#&gt; NG dist.                        0      0                   0    50</span></span>
<span><span class="co">#&gt; Oil fields                      0      0                   0  2575</span></span>
<span><span class="co">#&gt; Oil refineries                  0  26500                   0  5075</span></span>
<span><span class="co">#&gt; Petrol dist.                    0      0               26500   750</span></span>
<span><span class="co">#&gt; Power plants                    0      0                   0  9700</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span></code></pre></div>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ğ˜</mi><mi>â€²</mi></msup><annotation encoding="application/x-tex">\mathbf{Y}^{\prime}</annotation></semantics></math>
matrices also have a new column, by default named â€œLosses.â€</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endogenized</span><span class="op">$</span><span class="va">Y_prime</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                     Residential Transformation losses Transport</span></span>
<span><span class="co">#&gt; Diesel [from Dist.]           0                     0     14750</span></span>
<span><span class="co">#&gt; Elect [from Grid]          6000                     0         0</span></span>
<span><span class="co">#&gt; NG [from Dist.]           25000                     0         0</span></span>
<span><span class="co">#&gt; Petrol [from Dist.]           0                     0     26000</span></span>
<span><span class="co">#&gt; Waste                         0                 21250         0</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span></code></pre></div>
<p>In addition, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ğ˜</mi><mi>â€²</mi></msup><annotation encoding="application/x-tex">\mathbf{Y}^{\prime}</annotation></semantics></math>
matrices contain a new row (again named â€œWaste heatâ€ by default) that
shows the total heat loss in a new â€œLossesâ€ column.</p>
<p>To accept the endogenized matrices, set
<code>replace_cols = TRUE</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endogenized2</span> <span class="op">&lt;-</span> <span class="va">iibs_with_loss_allocs</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/endogenize_losses.html">endogenize_losses</a></span><span class="op">(</span>replace_cols <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">endogenized2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 2</span></span>
<span><span class="co">#&gt; Columns: 12</span></span>
<span><span class="co">#&gt; $ Country    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GBR"<span style="color: #949494;">, </span>"GBR"</span></span>
<span><span class="co">#&gt; $ Year       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2000<span style="color: #949494;">, </span>2000</span></span>
<span><span class="co">#&gt; $ EnergyType <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E"<span style="color: #949494;">, </span>"E"</span></span>
<span><span class="co">#&gt; $ LastStage  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final"<span style="color: #949494;">, </span>"Useful"</span></span>
<span><span class="co">#&gt; $ R          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[2 x 2]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[2 x 2]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 13]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_EIOU     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 8]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[3 x 8]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_feed     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[12 x 13]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ V          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 11]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 15]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Y          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[5 x 3]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[5 x 3]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r_EIOU     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 9]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[13 x 13]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ S_units    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;<span style="color: #949494;">, </span>&lt;&lt;matrix[16 x 1]&gt;&gt;</span></span>
<span><span class="va">endogenized2</span><span class="op">$</span><span class="va">Y</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># Same as endogenized$Y_prime[[1]]</span></span>
<span><span class="co">#&gt;                     Residential Transformation losses Transport</span></span>
<span><span class="co">#&gt; Diesel [from Dist.]           0                     0     14750</span></span>
<span><span class="co">#&gt; Elect [from Grid]          6000                     0         0</span></span>
<span><span class="co">#&gt; NG [from Dist.]           25000                     0         0</span></span>
<span><span class="co">#&gt; Petrol [from Dist.]           0                     0     26000</span></span>
<span><span class="co">#&gt; Waste                         0                 21250         0</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-value-added-matrix-mathbfw">The value added matrix
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ–</mi><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#the-value-added-matrix-mathbfw"></a>
</h3>
<p>The value added matrix
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ–</mi><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math>)
obtained from <code><a href="../reference/calc_yqfgW.html">calc_yqfgW()</a></code> is similar to but different from
the balances obtained from <code><a href="../reference/balances.html">calc_inter_industry_balance()</a></code>
and <code><a href="../reference/balances.html">calc_intra_industry_balance()</a></code>. The following equations
show the similarities and differences.</p>
<p>The value added matrix
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ–</mi><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math>)
is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ–</mi><mo>=</mo><msup><mi>ğ•</mi><mi mathvariant="normal">T</mi></msup><mo>âˆ’</mo><mi>ğ”</mi></mrow><annotation encoding="application/x-tex">\mathbf{W} = \mathbf{V}^{\mathrm{T}} - \mathbf{U}</annotation></semantics></math></p>
<p>Inter-industry balances are calculated by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‘</mi><mo>+</mo><mi>ğ•</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi mathvariant="normal">T</mi></msup><mo>âˆ’</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ”</mi><mo>+</mo><mi>ğ˜</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>ğ¢</mi></mrow><annotation encoding="application/x-tex">[(\mathbf{R} + \mathbf{V})^\mathrm{T}  - (\mathbf{U} + \mathbf{Y})] \mathbf{i}</annotation></semantics></math></p>
<p>and the intra-industry balances are calculated by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ğ”</mi><mi mathvariant="normal">T</mi></msup><mo>âˆ’</mo><mi>ğ•</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>ğ¢</mi><mspace width="0.167em"></mspace><mi>.</mi></mrow><annotation encoding="application/x-tex">(\mathbf{U}^\mathrm{T} - \mathbf{V})  \mathbf{i} \, .</annotation></semantics></math></p>
<p>The value added matrix
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ–</mi><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math>)
is closest to the intra-industry balances, but</p>
<ul>
<li>with the opposite sense (in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ–</mi><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math>
products are in rows; in the intra-industry balances, industries are in
rows),</li>
<li>without summation by the unit vector
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ¢</mi><annotation encoding="application/x-tex">\mathbf{i}</annotation></semantics></math>),
and</li>
<li>with opposite sign (in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ–</mi><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math>,
losses are negative; in the intra-industry balance, losses are
positive).</li>
</ul>
<p>The following code shows the comparison between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ–</mi><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math>
and intra-industry balances.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare</span> <span class="op">&lt;-</span> <span class="va">ecc</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/calc_yqfgW.html">calc_yqfgW</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/balances.html">calc_intra_industry_balance</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Calculate column sums of W and </span></span>
<span><span class="co"># transpose to create a column vector </span></span>
<span><span class="co"># for easier comparison</span></span>
<span><span class="va">compare</span><span class="op">$</span><span class="va">W</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/colsums_byname.html" class="external-link">colsums_byname</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">matsbyname</span><span class="fu">::</span><span class="fu"><a href="https://matthewheun.github.io/matsbyname/reference/transpose_byname.html" class="external-link">transpose_byname</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   Product</span></span>
<span><span class="co">#&gt; Crude dist.          -550</span></span>
<span><span class="co">#&gt; Diesel dist.         -350</span></span>
<span><span class="co">#&gt; Elect. grid          -125</span></span>
<span><span class="co">#&gt; Gas wells &amp; proc.   -2075</span></span>
<span><span class="co">#&gt; NG dist.              -50</span></span>
<span><span class="co">#&gt; Oil fields          -2575</span></span>
<span><span class="co">#&gt; Oil refineries      -5075</span></span>
<span><span class="co">#&gt; Petrol dist.         -750</span></span>
<span><span class="co">#&gt; Power plants        -9700</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co"># Compare to the intra-industry balance</span></span>
<span><span class="va">compare</span><span class="op">$</span><span class="va">SUTIntraIndustryBalance</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   Product</span></span>
<span><span class="co">#&gt; Crude dist.           550</span></span>
<span><span class="co">#&gt; Diesel dist.          350</span></span>
<span><span class="co">#&gt; Elect. grid           125</span></span>
<span><span class="co">#&gt; Gas wells &amp; proc.    2075</span></span>
<span><span class="co">#&gt; NG dist.               50</span></span>
<span><span class="co">#&gt; Oil fields           2575</span></span>
<span><span class="co">#&gt; Oil refineries       5075</span></span>
<span><span class="co">#&gt; Petrol dist.          750</span></span>
<span><span class="co">#&gt; Power plants         9700</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="deprecated-functions">Deprecated functions<a class="anchor" aria-label="anchor" href="#deprecated-functions"></a>
</h3>
<p>Two related functions in the <code>Recca</code> package have been
deprecated and will soon be removed.</p>
<div class="section level4">
<h4 id="verify_sut_energy_balance">
<code>verify_SUT_energy_balance()</code><a class="anchor" aria-label="anchor" href="#verify_sut_energy_balance"></a>
</h4>
<p><code><a href="../reference/verify_SUT_energy_balance.html">verify_SUT_energy_balance()</a></code> has been deprecated for two
reasons.</p>
<ul>
<li>
<code><a href="../reference/verify_SUT_energy_balance.html">verify_SUT_energy_balance()</a></code> unfortunately combined
<code><a href="../reference/balances.html">calc_inter_industry_balance()</a></code> and
<code><a href="../reference/verify-balances.html">verify_inter_industry_balance()</a></code> in a single step. We often
need to know the balances independently from whether products are
balanced. The combination of <code><a href="../reference/balances.html">calc_inter_industry_balance()</a></code>
and <code><a href="../reference/verify-balances.html">verify_inter_industry_balance()</a></code> provides the needed
flexibility.</li>
<li>Using â€œenergyâ€ in the name of the function was an unfortunate
choice, because we can use the same mathematics to balance masses or
exergies. The new function names are independent of the type products in
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ‘</mi><mi>ğ”</mi><mi>ğ•</mi><mi>ğ˜</mi></mrow><annotation encoding="application/x-tex">\mathbf{RUVY}</annotation></semantics></math>
matrices and are, therefore, an improvement.</li>
</ul>
<p>For now, <code><a href="../reference/verify_SUT_energy_balance.html">verify_SUT_energy_balance()</a></code> remains in the
<code>Recca</code> package but will likely be removed at a later
date.</p>
</div>
<div class="section level4">
<h4 id="verify_sut_energy_balance_with_units">
<code>verify_SUT_energy_balance_with_units()</code><a class="anchor" aria-label="anchor" href="#verify_sut_energy_balance_with_units"></a>
</h4>
<p><code><a href="../reference/verify_SUT_energy_balance_with_units.html">verify_SUT_energy_balance_with_units()</a></code> seemed like a
good idea at the time, but we have never used it. For now,
<code><a href="../reference/verify_SUT_energy_balance_with_units.html">verify_SUT_energy_balance_with_units()</a></code> remains in the
<code>Recca</code> package but will likely be removed at a later
date.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>There are several types of balances that are of interest to energy
and material conversion chain analysts. The functions
<code><a href="../reference/balances.html">calc_inter_industry_balance()</a></code>,
<code><a href="../reference/verify-balances.html">verify_inter_industry_balance()</a></code>,
<code><a href="../reference/balances.html">calc_intra_industry_balance()</a></code>,
<code><a href="../reference/verify-balances.html">verify_intra_industry_balance()</a></code>, and
<code><a href="../reference/endogenize_losses.html">endogenize_losses()</a></code> assist with those analyses.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Heun, Emmanuel Aramendia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
