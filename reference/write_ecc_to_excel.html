<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Write energy conversion chain matrices to an Excel file — write_ecc_to_excel • Recca</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Write energy conversion chain matrices to an Excel file — write_ecc_to_excel"><meta name="description" content="It is often helpful to see energy conversion chain (ECC) matrices in Excel format,
arranged spatially.
This function takes ECC matrices and writes them to an Excel file."><meta property="og:description" content="It is often helpful to see energy conversion chain (ECC) matrices in Excel format,
arranged spatially.
This function takes ECC matrices and writes them to an Excel file."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Recca</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.59</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Recca.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Aggregation.html">Aggregation</a></li>
    <li><a class="dropdown-item" href="../articles/new-function-interaction.html">new_* function interactions</a></li>
    <li><a class="dropdown-item" href="../articles/new-functions.html">new_* functions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MatthewHeun/Recca/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Write energy conversion chain matrices to an Excel file</h1>
      <small class="dont-index">Source: <a href="https://github.com/MatthewHeun/Recca/blob/v0.1.59/R/excel.R" class="external-link"><code>R/excel.R</code></a></small>
      <div class="d-none name"><code>write_ecc_to_excel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>It is often helpful to see energy conversion chain (ECC) matrices in Excel format,
arranged spatially.
This function takes ECC matrices and writes them to an Excel file.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">write_ecc_to_excel</span><span class="op">(</span></span>
<span>  .psut_data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">path</span>,</span>
<span>  overwrite_file <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  worksheet_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pad <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  include_named_regions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  R <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">R</span>,</span>
<span>  U <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">U</span>,</span>
<span>  V <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">V</span>,</span>
<span>  Y <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">Y</span>,</span>
<span>  r_eiou <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">r_eiou</span>,</span>
<span>  U_eiou <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">U_eiou</span>,</span>
<span>  U_feed <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">U_feed</span>,</span>
<span>  S_units <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">S_units</span>,</span>
<span>  .wrote_mats_colname <span class="op">=</span> <span class="st">"Wrote mats"</span>,</span>
<span>  UV_bg_color <span class="op">=</span> <span class="st">"#FDF2D0"</span>,</span>
<span>  RY_bg_color <span class="op">=</span> <span class="st">"#D3712D"</span>,</span>
<span>  calculated_bg_color <span class="op">=</span> <span class="st">"#D9D9D9"</span>,</span>
<span>  col_widths <span class="op">=</span> <span class="fl">7</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--psut-data">.psut_data<a class="anchor" aria-label="anchor" href="#arg--psut-data"></a></dt>
<dd><p>A list or data frame of energy conversion chains.
Default is <code>NULL</code>, in which case
single matrices can be supplied in the
<code>R</code>, <code>U</code>, <code>V</code>, <code>Y</code>, <code>r_eiou</code>, <code>U_eiou</code>, <code>U_feed</code>, and <code>S_units</code>
arguments.</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>The path of the Excel file to be created.</p></dd>


<dt id="arg-overwrite-file">overwrite_file<a class="anchor" aria-label="anchor" href="#arg-overwrite-file"></a></dt>
<dd><p>A boolean that tells whether you want to overwrite
the file at <code>path</code>, if it already exists.
Default is <code>FALSE</code>.</p></dd>


<dt id="arg-worksheet-names">worksheet_names<a class="anchor" aria-label="anchor" href="#arg-worksheet-names"></a></dt>
<dd><p>A string or string vector identifying
the names for the worksheets in the workbook.
Alternatively, when <code>.psut_data</code> is a data frame,
the string name of a column in the data frame
containing the names of the worksheets.
When <code>NULL</code>, the default, tabs are
numbered sequentially.</p></dd>


<dt id="arg-pad">pad<a class="anchor" aria-label="anchor" href="#arg-pad"></a></dt>
<dd><p>The number of rows and columns between adjacent matrices in the Excel sheet.
Default is <code>2</code>.</p></dd>


<dt id="arg-include-named-regions">include_named_regions<a class="anchor" aria-label="anchor" href="#arg-include-named-regions"></a></dt>
<dd><p>A boolean that tells whether to name regions of
the Excel tabs according to matrices.
Default is <code>TRUE</code>.</p></dd>


<dt id="arg-r-u-u-feed-u-eiou-r-eiou-v-y-s-units">R, U, U_feed, U_eiou, r_eiou, V, Y, S_units<a class="anchor" aria-label="anchor" href="#arg-r-u-u-feed-u-eiou-r-eiou-v-y-s-units"></a></dt>
<dd><p>Names of ECC matrices or actual matrices.
See <code><a href="psut_cols.html">Recca::psut_cols</a></code>.</p></dd>


<dt id="arg--wrote-mats-colname">.wrote_mats_colname<a class="anchor" aria-label="anchor" href="#arg--wrote-mats-colname"></a></dt>
<dd><p>The name of the outgoing column
that tells whether a worksheet was written successfully.
Default is "Wrote mats".</p></dd>


<dt id="arg-uv-bg-color">UV_bg_color<a class="anchor" aria-label="anchor" href="#arg-uv-bg-color"></a></dt>
<dd><p>The color of cells containing U and V matrices.
Default is a creamy yellow.</p></dd>


<dt id="arg-ry-bg-color">RY_bg_color<a class="anchor" aria-label="anchor" href="#arg-ry-bg-color"></a></dt>
<dd><p>The color of cells containing R and Y matrices.
Default is a rust color.</p></dd>


<dt id="arg-calculated-bg-color">calculated_bg_color<a class="anchor" aria-label="anchor" href="#arg-calculated-bg-color"></a></dt>
<dd><p>The color of cells containing calculated matrices.
Default is gray.</p></dd>


<dt id="arg-col-widths">col_widths<a class="anchor" aria-label="anchor" href="#arg-col-widths"></a></dt>
<dd><p>The widths of columns of matrices.
Default is <code>7</code> to save space.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An unmodified version of <code>.psut_data</code> (if not <code>NULL</code>) or a list of
the incoming matrices.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If <code>.psut_data</code> is a PSUT data frame,
each row is written to a different tab in the output file at <code>path</code>.</p>
<p>When <code>worksheet_names</code> is not <code>NULL</code> (the default),
be sure that worksheet names are unique.
Also, be aware that worksheet names
must have 31 characters or fewer.
Furthermore, the worksheet names
may not contain any of the following characters:
<code>\  /  ?  *  [  ]</code>.</p>
<p>When <code>include_named_regions</code> is <code>TRUE</code> (the default),
named regions for matrices are added to Excel sheets.
The format for the names is <code>&lt;&lt;matrix symbol&gt;&gt;_&lt;&lt;worksheet name&gt;&gt;</code>.
For example, "R_4" for the <strong>R</strong> matrix on the sheet named "4".
The names help to identify matrices in high-level overviews of the Excel file
and can also be used for later reading matrices from Excel files.
The region names apply to the numbers in a matrix only,
not to the row and column labels.
Row names are one column left of the named region.
Column names are one row above the named region.</p>
<p>Note that region names are more restricted than worksheet names and
may not contain any of the following characters:
<code>! @ # $ % ^ &amp; * ( ) + - / = { } [ ] | \ : ; " ' &lt; &gt; , . ? spaces</code>.
Best to stick with letters, numbers, and underscores.</p>
<p>Finally, note that because region names include the worksheet name,
worksheet names should avoid illegal characters for region names.
Again, best to stick with letters, numbers, and underscores.</p>
<p>A warning is given when any worksheet names or region names
contain illegal characters.</p>
<p>[  ]: R:%20%20
[ ]: R:%20</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">ecc</span> <span class="op">&lt;-</span> <span class="va">UKEnergy2000mats</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"matrix.name"</span>,</span></span>
<span class="r-in"><span>                     values_from <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="co"># Specify worksheet names using metadata guaranteed to be unique.</span></span></span>
<span class="r-in"><span>  worksheet_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">EnergyType</span>, <span class="va">LastStage</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ecc_temp_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"write_excel_ecc_test_file"</span>, fileext <span class="op">=</span> <span class="st">".xlsx"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">write_ecc_to_excel</span><span class="op">(</span><span class="va">ecc</span>,</span></span>
<span class="r-in"><span>                   path <span class="op">=</span> <span class="va">ecc_temp_path</span>,</span></span>
<span class="r-in"><span>                   worksheet_names <span class="op">=</span> <span class="st">"worksheet_names"</span>,</span></span>
<span class="r-in"><span>                   overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Heun, Emmanuel Aramendia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

