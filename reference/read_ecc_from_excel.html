<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Read an energy conversion chain from a Excel file — read_ecc_from_excel • Recca</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read an energy conversion chain from a Excel file — read_ecc_from_excel"><meta name="description" content='Reads matrices from named regions in an Excel file
into matsindf format.
The named regions are assumed to be global
to the workbook.
The format for the region names is assumed to be
&amp;lt;&amp;lt;matrix symbol&amp;gt;&amp;gt;&amp;lt;&amp;lt;sep&amp;gt;&amp;gt;&amp;lt;&amp;lt;worksheet name&amp;gt;&amp;gt;,
as written by write_ecc_to_excel().
For example, "R__4" for the R matrix on the sheet named "4".'><meta property="og:description" content='Reads matrices from named regions in an Excel file
into matsindf format.
The named regions are assumed to be global
to the workbook.
The format for the region names is assumed to be
&amp;lt;&amp;lt;matrix symbol&amp;gt;&amp;gt;&amp;lt;&amp;lt;sep&amp;gt;&amp;gt;&amp;lt;&amp;lt;worksheet name&amp;gt;&amp;gt;,
as written by write_ecc_to_excel().
For example, "R__4" for the R matrix on the sheet named "4".'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Recca</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.62</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Recca.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Aggregation.html">Aggregation</a></li>
    <li><a class="dropdown-item" href="../articles/new-function-interaction.html">new_* function interactions</a></li>
    <li><a class="dropdown-item" href="../articles/new-functions.html">new_* functions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MatthewHeun/Recca/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Read an energy conversion chain from a Excel file</h1>
      <small class="dont-index">Source: <a href="https://github.com/MatthewHeun/Recca/blob/master/R/excel.R" class="external-link"><code>R/excel.R</code></a></small>
      <div class="d-none name"><code>read_ecc_from_excel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Reads matrices from named regions in an Excel file
into <code>matsindf</code> format.
The named regions are assumed to be global
to the workbook.
The format for the region names is assumed to be
<code>&lt;&lt;matrix symbol&gt;&gt;&lt;&lt;sep&gt;&gt;&lt;&lt;worksheet name&gt;&gt;</code>,
as written by <code><a href="write_ecc_to_excel.html">write_ecc_to_excel()</a></code>.
For example, "R__4" for the <strong>R</strong> matrix on the sheet named "4".</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read_ecc_from_excel</span><span class="op">(</span></span>
<span>  <span class="va">path</span>,</span>
<span>  worksheets <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_rc_types <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  worksheet_names_colname <span class="op">=</span> <span class="st">"WorksheetNames"</span>,</span>
<span>  R <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">R</span>,</span>
<span>  U <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">U</span>,</span>
<span>  V <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">V</span>,</span>
<span>  Y <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">Y</span>,</span>
<span>  r_eiou <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">r_eiou</span>,</span>
<span>  U_eiou <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">U_eiou</span>,</span>
<span>  U_feed <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">U_feed</span>,</span>
<span>  S_units <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="psut_cols.html">psut_cols</a></span><span class="op">$</span><span class="va">S_units</span>,</span>
<span>  industry_type <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="row_col_types.html">row_col_types</a></span><span class="op">$</span><span class="va">industry_type</span>,</span>
<span>  product_type <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="row_col_types.html">row_col_types</a></span><span class="op">$</span><span class="va">product_type</span>,</span>
<span>  unit_type <span class="op">=</span> <span class="fu">Recca</span><span class="fu">::</span><span class="va"><a href="row_col_types.html">row_col_types</a></span><span class="op">$</span><span class="va">unit_type</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"__"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>The path to the Excel file.</p></dd>


<dt id="arg-worksheets">worksheets<a class="anchor" aria-label="anchor" href="#arg-worksheets"></a></dt>
<dd><p>Names of worksheets from which matrices
are to be read.
Default is <code>NULL</code>, meaning that all
worksheets are read.</p></dd>


<dt id="arg-add-rc-types">add_rc_types<a class="anchor" aria-label="anchor" href="#arg-add-rc-types"></a></dt>
<dd><p>A boolean that tells whether to
add row and column types
to the outgoing matrices.
When <code>TRUE</code>, matrix names are determined by
<code><a href="add_row_col_types.html">add_row_col_types()</a></code>.
Default is <code>TRUE</code>.</p></dd>


<dt id="arg-worksheet-names-colname">worksheet_names_colname<a class="anchor" aria-label="anchor" href="#arg-worksheet-names-colname"></a></dt>
<dd><p>The name of a column in
the outgoing data frame that
contains the names of worksheets
on which the matrices were found.
Default is "WorksheetNames".</p></dd>


<dt id="arg-r-u-v-y-r-eiou-u-eiou-u-feed-s-units">R, U, V, Y, r_eiou, U_eiou, U_feed, S_units<a class="anchor" aria-label="anchor" href="#arg-r-u-v-y-r-eiou-u-eiou-u-feed-s-units"></a></dt>
<dd><p>String names for regions
in the file at <code>path</code>
containing matrices.
See <code><a href="psut_cols.html">Recca::psut_cols</a></code>
for defaults.</p></dd>


<dt id="arg-industry-type-product-type-unit-type">industry_type, product_type, unit_type<a class="anchor" aria-label="anchor" href="#arg-industry-type-product-type-unit-type"></a></dt>
<dd><p>String names of row and
column types optionally
applied to matrices
read from the file at
<code>path</code>.
Defaults are taken from
<code><a href="row_col_types.html">Recca::row_col_types</a></code>.</p></dd>


<dt id="arg-sep">sep<a class="anchor" aria-label="anchor" href="#arg-sep"></a></dt>
<dd><p>The separator between matrix name and worksheet name
for named regions.
Default is "__".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame in <code>matsindf</code> format containing
the matrices from named regions in
the file at <code>path</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Named regions are assumed to include
the rectangle of numerical values,
row names (to the left of the rectangle of numbers), and
column names (above the rectangle of numbers),
the same format
as written by <code><a href="write_ecc_to_excel.html">write_ecc_to_excel()</a></code>.</p>
<p>This function is an inverse of <code><a href="write_ecc_to_excel.html">write_ecc_to_excel()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="write_ecc_to_excel.html">write_ecc_to_excel()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">ecc</span> <span class="op">&lt;-</span> <span class="va">UKEnergy2000mats</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"matrix.name"</span>, value <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      WorksheetNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">EnergyType</span>, <span class="st">"_"</span>, <span class="va">LastStage</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ecc_temp_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"write_excel_ecc_test_file"</span>,</span></span>
<span class="r-in"><span>                            fileext <span class="op">=</span> <span class="st">".xlsx"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="write_ecc_to_excel.html">write_ecc_to_excel</a></span><span class="op">(</span><span class="va">ecc</span>,</span></span>
<span class="r-in"><span>                     path <span class="op">=</span> <span class="va">ecc_temp_path</span>,</span></span>
<span class="r-in"><span>                     worksheet_names <span class="op">=</span> <span class="st">"WorksheetNames"</span>,</span></span>
<span class="r-in"><span>                     overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Now read the regions</span></span></span>
<span class="r-in"><span>  <span class="va">ecc_temp_path</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">read_ecc_from_excel</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">ecc_temp_path</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="va">ecc_temp_path</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Heun, Emmanuel Aramendia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

